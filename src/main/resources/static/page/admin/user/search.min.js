layui.use(["layer"],function(){layer=layui.layer;querySearch({});$(".senior-condition-btn").click(function(){$(".senior-condition").toggle("fast")})});var users;function search(a){a={};a.t=Math.random();var b=$('[name\x3d"registerStartTime"]').val();isNotEmpty(b)&&(a.register_time_start=b);b=$('[name\x3d"registerEndTime"]').val();isNotEmpty(b)&&(a.register_time_end=endTime);b=$('[name\x3d"birthStartTime"]').val();isNotEmpty(b)&&(a.birth_time_start=b);b=$('[name\x3d"birthEndTime"]').val();isNotEmpty(b)&&(a.birth_time_end=b);b=$('[name\x3d"searchKey"]').val();isNotEmpty(b)&&(a.search_key=b);querySearch(a)}function querySearch(a){var b=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({url:"/us/websearch?"+jsonToGetRequestParams(a),dataType:"json",beforeSend:function(){isChart=!0},success:function(a){layer.close(b);if(a.success)if($(".each-row").remove(),users=a.message,0==users.length)layer.msg("\u65e0\u66f4\u591a\u6570\u636e");else for(var c=0;c<a.message.length;c++)buildEachRow(a.message[c],c);else ajaxError(a)},error:function(a){layer.close(b);ajaxError(a)}})}function buildEachRow(a,b){var c="",c="undefined"!=typeof a.user_pic_path&&isNotEmpty(a.user_pic_path)?c+('\x3cdiv class\x3d"row list-row each-row" index\x3d'+b+" data-id\x3d"+a.id+'\x3e\x3cdiv class\x3d"col-lg-12"\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col-lg-1 col-md-1 col-sm-2 col-xs-2"\x3e\x3cimg class\x3d"img-circle" alt\x3d"" width\x3d"40" height\x3d"40" src\x3d"'+a.user_pic_path+'"\x3e\x3c/div\x3e\x3cdiv class\x3d"col-lg-11 col-md-11 col-sm-10 col-xs-10"\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u8d26\u53f7\uff1a'+changeNotNullString(a.account)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u771f\u5b9e\u59d3\u540d\uff1a'+changeNotNullString(a.real_name)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u4e2d\u6587\u540d\uff1a'+changeNotNullString(a.china_name)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3" padding-five\x3e\x3cdiv class\x3d"row" style\x3d"text-align: right;"\x3e\x3cbutton type\x3d"button" class\x3d"btn btn-primary btn-sm" onclick\x3d"showEditUser(this, '+b+');"\x3e\u7f16\u8f91\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u51fa\u751f\u65e5\u671f\uff1a'+changeNotNullString(a.birth_date)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u6027\u522b\uff1a'+changeNotNullString(a.sex)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u7c4d\u8d2f\uff1a'+changeNotNullString(a.nation)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3 padding-five"\x3e\x3cdiv class\x3d"row" style\x3d"text-align: right;"\x3e\x3cbutton type\x3d"button" class\x3d"btn btn-primary btn-sm" onclick\x3d"deleteUser(this, '+b+');"\x3e\u5220\u9664\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col-lg-3"\x3eQQ\u53f7\u7801\uff1a'+changeNotNullString(a.qq)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u624b\u673a\u53f7\u7801\uff1a'+changeNotNullString(a.mobile_phone)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u6ce8\u518c\u65f6\u95f4\uff1a'+changeNotNullString(a.register_time)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3 padding-five"\x3e\x3cdiv class\x3d"row" style\x3d"text-align: right;"\x3e\x3cbutton type\x3d"button" class\x3d"btn btn-primary btn-sm" onclick\x3d"showSendMessage(this, '+b+');"\x3e\u53d1\u4fe1\u606f\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u90ae\u4ef6\uff1a'+changeNotNullString(a.email)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u6559\u80b2\u80cc\u666f\uff1a'+changeNotNullString(a.education_background)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u51fa\u751f\u5730\uff1a'+changeNotNullString(a.native_place)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3 padding-five"\x3e\x3cdiv class\x3d"row" style\x3d"text-align: right;"\x3e\x3cbutton type\x3d"button" class\x3d"btn btn-primary btn-sm" onclick\x3d"resetPassword(this, '+b+');"\x3e\u91cd\u7f6e\u5bc6\u7801\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col-lg-9"\x3e\x3cdiv class\x3d"form-group"\x3e\u4e2a\u4eba\u7b80\u4ecb\uff1a'+changeNotNullString(a.personal_introduction)+'\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"col-lg-3 padding-five"\x3e\x3cdiv class\x3d"row" style\x3d"text-align: right;"\x3e\x3cbutton type\x3d"button" class\x3d"btn btn-primary btn-sm" onclick\x3d"showUploadHeadLink(this, '+b+');"\x3e\u4e0a\u4f20\u5934\u50cf\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'):c+('\x3cdiv class\x3d"row list-row each-row" data-id\x3d'+a.id+'\x3e\x3cdiv class\x3d"col-lg-12"\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col-lg-12"\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u8d26\u53f7\uff1a'+changeNotNullString(a.account)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u771f\u5b9e\u59d3\u540d\uff1a'+changeNotNullString(a.real_name)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u4e2d\u6587\u540d\uff1a'+changeNotNullString(a.china_name)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3 padding-five"\x3e\x3cdiv class\x3d"row" style\x3d"text-align: right;"\x3e\x3cbutton type\x3d"button" class\x3d"btn btn-primary btn-sm" onclick\x3d"showEditUser(this, '+b+');"\x3e\u7f16\u8f91\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u51fa\u751f\u65e5\u671f\uff1a'+changeNotNullString(a.birth_date)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u6027\u522b\uff1a'+changeNotNullString(a.sex)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u7c4d\u8d2f\uff1a'+changeNotNullString(a.nation)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3 padding-five"\x3e\x3cdiv class\x3d"row" style\x3d"text-align: right;"\x3e\x3cbutton type\x3d"button" class\x3d"btn btn-primary btn-sm" onclick\x3d"deleteUser(this, '+b+');"\x3e\u5220\u9664\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col-lg-3"\x3eQQ\u53f7\u7801\uff1a'+changeNotNullString(a.qq)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u624b\u673a\u53f7\u7801\uff1a'+changeNotNullString(a.mobile_phone)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u6ce8\u518c\u65f6\u95f4\uff1a'+changeNotNullString(a.register_time)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3 padding-five"\x3e\x3cdiv class\x3d"row" style\x3d"text-align: right;"\x3e\x3cbutton type\x3d"button" class\x3d"btn btn-primary btn-sm" onclick\x3d"showSendMessage(this, '+b+');"\x3e\u53d1\u4fe1\u606f\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u90ae\u4ef6\uff1a'+changeNotNullString(a.email)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u6559\u80b2\u80cc\u666f\uff1a'+changeNotNullString(a.education_background)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3"\x3e\u51fa\u751f\u5730\uff1a'+changeNotNullString(a.native_place)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-3 padding-five"\x3e\x3cdiv class\x3d"row" style\x3d"text-align: right;"\x3e\x3cbutton type\x3d"button" class\x3d"btn btn-primary btn-sm" onclick\x3d"resetPassword(this, '+b+');"\x3e\u91cd\u7f6e\u5bc6\u7801\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col-lg-9"\x3e\x3cdiv class\x3d"form-group"\x3e\u4e2a\u4eba\u7b80\u4ecb\uff1a'+changeNotNullString(a.personal_introduction)+'\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"col-lg-3 padding-five"\x3e\x3cdiv class\x3d"row" style\x3d"text-align: right;"\x3e\x3cbutton type\x3d"button" class\x3d"btn btn-primary btn-sm" onclick\x3d"showUploadHeadLink(this, '+b+');"\x3e\u4e0a\u4f20\u5934\u50cf\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e');$(".mainContainer").append(c)}function showEditUser(a,b){var c=users[b];$("#edit-user-info").attr("data-id",c.id);$("#edit-user-info").find('[name\x3d"account"]').val(changeNotNullString(c.account));$("#edit-user-info").find('[name\x3d"personal_introduction"]').val(changeNotNullString(c.personal_introduction));for(var c=c.status,d=$(".status-btn"),e=0;e<d.length;e++)if(parseInt($(d[e]).find("input").attr("type-value"))==c){$(d[e]).addClass("active");break}$("#edit-user-info").modal("show")}function editUser(a){var b=$(a).closest("#edit-user-info");a=b.find('[name\x3d"account"]').val();if(isEmpty(a))layer.msg("\u8d26\u53f7\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a"),b.find('[name\x3d"account"]').focus();else{for(var c=0,d=$(".status-btn"),e=0;e<d.length;e++)if($(d[e]).hasClass("active")){c=$(d[e]).find("input").attr("type-value");break}b=b.find('[name\x3d"personal_introduction"]').val();a={to_user_id:$("#edit-user-info").attr("data-id"),account:a,personal_introduction:b,status:c,t:Math.random()};var f=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"put",data:a,url:"/us/ad/user",dataType:"json",beforeSend:function(){},success:function(a){layer.close(f);a.success?(layer.msg(a.message+",1\u79d2\u949f\u540e\u81ea\u52a8\u5237\u65b0"),setTimeout("window.location.reload();",1E3)):ajaxError(a)},error:function(a){layer.close(f);ajaxError(a)}})}}function deleteUser(a,b){"undefined"!=typeof users&&0<users.length&&users.length>b?layer.confirm("\u60a8\u8981\u5220\u9664\u8be5\u7528\u6237\u5417\uff1f\u6ce8\u610f\uff1a\u8fd9\u662f\u4e0d\u53ef\u9006\u884c\u4e3a\u3002",{btn:["\u786e\u5b9a","\u70b9\u9519\u4e86"]},function(){var b=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026"),d=$(a).closest(".each-row").attr("data-id");$.ajax({type:"delete",url:"/us/user?to_user_id\x3d"+d,dataType:"json",beforeSend:function(){},success:function(a){layer.close(b);a.success?(layer.msg(a.message+",1\u79d2\u949f\u540e\u81ea\u52a8\u5237\u65b0"),setTimeout("window.location.reload();",1E3)):ajaxError(a)},error:function(a){layer.close(b);ajaxError(a)}})},function(){}):layer.msg("\u9875\u9762\u53c2\u6570\u6709\u8bef\uff0c\u8bf7\u5237\u65b0\uff01")}function resetPassword(a,b){"undefined"!=typeof users&&0<users.length&&users.length>b?layer.confirm("\u60a8\u8981\u91cd\u7f6e\u8be5\u7528\u6237\u7684\u767b\u5f55\u5bc6\u7801\u5417\uff1f\u6ce8\u610f\uff1a\u8fd9\u662f\u4e0d\u53ef\u9006\u884c\u4e3a\u3002",{btn:["\u786e\u5b9a","\u70b9\u9519\u4e86"]},function(){var b=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026"),d=$(a).closest(".each-row").attr("data-id");$.ajax({type:"put",data:{to_user_id:d,t:Math.random()},url:"/us/ad/resetPwd",dataType:"json",beforeSend:function(){},success:function(a){layer.close(b);a.success?(layer.msg(a.message+",1\u79d2\u949f\u540e\u81ea\u52a8\u5237\u65b0"),reloadPage(1E3)):ajaxError(a)},error:function(a){layer.msg("\u7f51\u7edc\u8bf7\u6c42\u5931\u8d25");ajaxError(a)}})},function(){}):layer.msg("\u9875\u9762\u53c2\u6570\u6709\u8bef\uff0c\u8bf7\u5237\u65b0\uff01")}function showSendMessage(a,b){var c=users[b];isEmpty(c.email)?$("#send-message").find("#email").closest("label").addClass("disabled"):$("#send-message").find("#email").closest("label").removeClass("disabled");$("#send-message").find(".send-message-btn").removeClass("active");$("#send-message").find(".send-message-btn:first-child").addClass("active");$("#send-message").attr("data-id",c.id);$("#send-message").modal("show")}function sendMessage(a){var b=$(a).closest("#send-message");a=b.find('[name\x3d"content"]').val();if(isEmpty(a))layer.msg("\u53d1\u9001\u4fe1\u606f\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a"),b.find('[name\x3d"content"]').focus();else{b=$("#send-message").find(".btn-group label.active").children("input").attr("type-value");a={to_user_id:$("#send-message").attr("data-id"),type:b,content:a,t:Math.random()};var c=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"post",data:a,url:"/tl/sendMsg",dataType:"json",beforeSend:function(){},success:function(a){layer.close(c);a.success?(layer.msg(a.message),$("#send-message").modal("hide")):ajaxError(a)},error:function(a){layer.close(c);ajaxError(a)}})}}function showUploadHeadLink(a,b){var c=users[b];$("#upload-user-head").attr("data-id",c.id);$("#upload-user-head").modal("show")}function uploadHeadLink(a){a=$(a).closest("#upload-user-head");var b=a.find('input[name\x3d"link"]').val();if(isEmpty(b))layer.msg("\u8bf7\u5148\u8f93\u5165\u5934\u50cf\u56fe\u7247\u94fe\u63a5\uff01"),a.find('input[name\x3d"link"]').focus();else{a={to_user_id:$("#upload-user-head").attr("data-id"),link:b,t:Math.random()};var c=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"post",data:a,url:"/fp/uploadHeadImgLink",dataType:"json",beforeSend:function(){},success:function(a){layer.close(c);a.success?(layer.msg(a.message+",1\u79d2\u949f\u540e\u81ea\u52a8\u5237\u65b0"),reloadPage(1E3)):ajaxError(a)},error:function(a){layer.close(c);ajaxError(a)}})}};