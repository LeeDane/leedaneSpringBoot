var $usersContainer;layui.use(["layer","util"],function(){layer=layui.layer;util=layui.util;$usersContainer=$("#users-container");getActive()});function getActive(){var b=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({url:"/us/actives?t\x3d"+Math.random(),dataType:"json",beforeSend:function(){$usersContainer.empty()},success:function(a){layer.close(b);if(a.success)if($(".each-row").remove(),users=a.message,0==users.length)layer.msg("\u65e0\u66f4\u591a\u6570\u636e");else for(var c=0;c<a.message.length;c++)buildEachRow(a.message[c],c);else ajaxError(a)},error:function(a){layer.close(b);ajaxError(a)}})}function buildEachRow(b,a){var c=b.location+"---"+setTimeAgo(b.time);$usersContainer.append('\x3cbutton type\x3d"button" class\x3d"btn btn-danger btn-sm user-item" data-session\x3d"'+b.session+'" style\x3d"margin-top: 10px;" title\x3d"'+c+'" onclick\x3d"logout(this);"\x3e\x3cspan class\x3d"glyphicon glyphicon-off" aria-hidden\x3d"true"\x3e\x3c/span\x3e \x3cfont style\x3d"font-size: 16px;"\x3e'+b.name+"\x3c/font\x3e(\x3csmall\x3e"+b.ip+"\x3c/small\x3e)\x3c/button\x3e")}function logout(b){var a=$(b).data("session");layer.confirm("\u60a8\u8981\u5254\u9664\u8be5\u7528\u6237\u5417\uff1f",{btn:["\u786e\u5b9a","\u70b9\u9519\u4e86"]},function(){var b=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"delete",url:"/us/logoutOther?session\x3d"+a,dataType:"json",beforeSend:function(){},success:function(a){layer.close(b);a.success?(layer.msg(a.message+",1\u79d2\u540e\u81ea\u52a8\u5237\u65b0"),reloadPage(1E3)):ajaxError(a)},error:function(a){layer.close(b);ajaxError(a)}})},function(){})};