layui.use(["layer"],function(){layer=layui.layer;winH=$(window).height();queryPaging();$(window).scroll(function(a){a=a||window.event;if(a.wheelDelta){if(0<a.wheelDelta)return}else if(a.detail&&0<a.detail)return;a=$(document.body).height();var c=$(window).scrollTop();a=(a-winH-c)/winH;!isLoad&&.2>a&&canLoadData&&(isLoad=!0,method="lowloading",queryPaging())})});var last_id=0,first_id=0,method="firstloading",winH,canLoadData=!0,isLoad=!1,loginHostorys;function queryPaging(){var a=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({url:"/ol/logins?"+jsonToGetRequestParams(getQueryPagingParams()),dataType:"json",beforeSend:function(){},success:function(c){layer.close(a);if(c.success){if(0==c.message.length){canLoadData=!1;layer.msg("\u65e0\u66f4\u591a\u6570\u636e");return}if("firstloading"==method){$(".list-row").remove();loginHostorys=c.message;for(var b=0;b<loginHostorys.length;b++)buildEachRow(loginHostorys[b],b),0==b&&(first_id=loginHostorys[b].id),b==loginHostorys.length-1&&(last_id=loginHostorys[b].id)}else for(var d=loginHostorys.length,b=0;b<c.message.length;b++)loginHostorys.push(c.message[b]),buildEachRow(c.message[b],d),b==c.message.length-1&&(last_id=c.message[b].id)}else ajaxError(c);isLoad=!1},error:function(c){isLoad=!1;layer.close(a);ajaxError(c)}})}function getQueryPagingParams(){var a=15;"firstloading"!=method&&(a=10);return{pageSize:a,last_id:last_id,first_id:first_id,method:method,t:Math.random()}}function buildEachRow(a,c){var b='\x3cdiv class\x3d"row list-row"\x3e\x3cdiv class\x3d"col-lg-12"\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col-lg-5"\x3e\u767b\u5f55\u65b9\u5f0f\uff1a'+a.method+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-5"\x3e\u767b\u5f55\u65f6\u95f4\uff1a'+a.create_time+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-2"\x3e\u72b6\u6001\uff1a'+(1==a.status?"\u6b63\u5e38":"\u5f02\u5e38")+'\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col-lg-6 cut-text" title\x3d'+changeNotNullString(a.browser)+'"\x3e\u6d4f\u89c8\u5668\uff1a'+changeNotNullString(a.browser)+'\x3c/div\x3e\x3cdiv class\x3d"col-lg-6"\x3eIP\u5730\u5740\uff1a'+changeNotNullString(a.ip)+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e";$(".mainContainer").append(b)};