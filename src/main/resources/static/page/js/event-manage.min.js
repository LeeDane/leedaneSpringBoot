var testEditor;testEditor=editormd("test-editormd",{placeholder:"\u672c\u7f16\u8f91\u5668\u652f\u6301Markdown\u7f16\u8f91\uff0c\u5de6\u8fb9\u7f16\u5199\uff0c\u53f3\u8fb9\u9884\u89c8",width:"100%",height:450,syncScrolling:"single",path:"/page/other/editor-md-master/lib/",saveHTMLToTextarea:!0,emoji:!1,taskList:!0,tocm:!0,tex:!0,flowChart:!0,sequenceDiagram:!0,toolbarIcons:function(){return editormd.toolbarModes.full}});layui.use("table",function(){var c=layui.table;c.render({elem:"#test",url:"/ev/events",title:"\u6570\u636e\u8868",cols:[[{field:"id",title:"ID",width:80,unresize:!0,sort:!0},{field:"account",title:"\u8d26\u53f7",width:120},{field:"source",title:"\u6e90\u5185\u5bb9",width:180},{field:"content",title:"\u5185\u5bb9",width:450},{field:"modify_time",title:"\u6700\u540e\u4fee\u6539\u65f6\u95f4",width:120},{fixed:"right",title:"\u64cd\u4f5c",toolbar:"#barDemo",width:120}]],page:!0});c.on("toolbar(test)",function(a){var b=c.checkStatus(a.config.id);switch(a.event){case "getCheckData":a=b.data;layer.alert(JSON.stringify(a));break;case "getCheckLength":a=b.data;layer.msg("\u9009\u4e2d\u4e86\uff1a"+a.length+" \u4e2a");break;case "isAll":layer.msg(b.isAll?"\u5168\u9009":"\u672a\u5168\u9009")}});c.on("tool(test)",function(a){var b=a.data;"del"===a.event?layer.confirm("\u771f\u7684\u5220\u9664\u884c\u4e48",function(a){var c=layer.load("\u52aa\u529b\u5220\u9664\u4e2d\u2026");$.ajax({type:"delete",url:"/ev/manage?eid\x3d"+b.id,dataType:"json",beforeSend:function(){},success:function(a){layer.close(c);a.isSuccess?(layer.msg(a.message+",1\u79d2\u949f\u540e\u81ea\u52a8\u5237\u65b0"),setTimeout("window.location.reload();",1E3)):ajaxError(a)},error:function(a){layer.close(c);ajaxError(a)}})}):"edit"===a.event&&(testEditor.setMarkdown(b.source),$("#publish").text("\u7f16\u8f91"),eventId=b.id,scrollTop())})});var eventId=0;function addEvent(){isEmpty(testEditor.getMarkdown())?(testEditor.setMarkdown(""),$("#publish").text("\u53d1\u5e03"),eventId=0,scrollTop()):layer.confirm("MD\u7f16\u8f91\u5668\u8fd8\u6709\u5185\u5bb9\uff0c\u662f\u5426\u6e05\u7a7a\u540e\u518d\u7f16\u8f91\uff1f",{btn:["\u53d6\u6d88","\u786e\u5b9a"]},function(){layer.close()},function(){testEditor.setMarkdown("");$("#publish").text("\u53d1\u5e03");eventId=0;scrollTop()})}function scrollTop(){$("html,body").animate({scrollTop:0},500)}function publish(){if(isEmpty(testEditor.getMarkdown()))layer.msg("\u8bf7\u5148\u8f93\u5165\u5185\u5bb9\u518d\u63d0\u4ea4"),testEditor.autoFocus();else{var c={};0<eventId&&(c.eid=eventId);c.content=testEditor.getHTML();c.source=testEditor.getMarkdown();var a=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:1>eventId?"post":"put",data:c,url:"/ev/manage",dataType:"json",beforeSend:function(){},success:function(b){layer.close(a);b.isSuccess?(layer.msg(b.message+",1\u79d2\u949f\u540e\u81ea\u52a8\u5237\u65b0"),setTimeout("window.location.reload();",1E3)):ajaxError(b)},error:function(b){layer.close(a);ajaxError(b)}})}};