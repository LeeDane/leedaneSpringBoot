layui.use(["layer","laypage"],function(){layer=layui.layer;laypage=layui.laypage;$(".common-search").remove();searchKey=getURLParam(decodeURI(window.location.href),"q");isEmpty(searchKey)&&layer.msg("\u83b7\u53d6\u4e0d\u5230\u60a8\u8981\u68c0\u7d22\u7684\u5173\u952e\u5b57\uff01");$("#common-search-text").val(searchKey);doSearch();$ContentContainer=$("#content-contrainer");$("#notification-tabs").find("li").on("click",function(a){$("#notification-tabs").find("li").removeClass("active");$(this).addClass("active");type=parseInt($(this).attr("data-type"));currentIndex=0;doSearch()})});var type=1,accurate=0,searchKey,$ContentContainer,startDate="",endDate="2019-07-25";function search(a){a=$("#common-search-text").val();isEmpty(a)?(layer.msg("\u8bf7\u8f93\u5165\u60a8\u8981\u641c\u7d22\u7684\u5185\u5bb9\uff01"),$("#common-search-text").focus()):(searchKey=a,currentIndex=1,doSearch())}function getRequestParams(){return{page_size:pageSize,current:currentIndex,total:totalPage,keyword:searchKey,type:type,desc:!0,accurate:accurate,startDate:startDate,endDate:endDate,t:Math.random()}}function doSearch(){var a=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$("#notification-tabs li").find(".badge").remove();$.ajax({type:"get",url:"/s/es?"+jsonToGetRequestParams(getRequestParams()),dataType:"json",beforeSend:function(){$("#user-result-show").empty();$("#mood-result-show").empty();$("#blog-result-show").empty();$("#search-user-number").text(0);$("#search-mood-number").text(0);$("#search-blog-number").text(0)},success:function(b){layer.close(a);if(b.isSuccess&&isNotEmpty(b.message)){$("#search-need-time").text(b.consumeTime);b=b.message[0];$ContentContainer.empty();var c=b.hits;$("#notification-tabs .active").find("a").append('\x3cspan class\x3d"badge pull-right"\x3e'+b.total+"\x3c/span\x3e");0==c.length?0==currentIndex?$ContentContainer.append('\x3cdiv class\x3d"col-lg-12"\x3e\u6ca1\u6709\u68c0\u7d22\u5230\u6570\u636e\uff0c\u8bf7\u6362\u4e2a\u5173\u952e\u8bcd\u8bd5\u8bd5\uff01\x3c/div\x3e'):$ContentContainer.append('\x3cdiv class\x3d"col-lg-12"\x3e\u5df2\u7ecf\u6ca1\u6709\u66f4\u591a\u7684\u6570\u636e\u5566\uff01\x3c/div\x3e'):(1==type&&buildBlogs(c),2==type&&buildMoods(c),3==type&&buildUsers(c),6==type&&buildLogs(c),laypage.render({elem:"item-pager",layout:["prev","page","next","count","skip"],count:b.total,limit:pageSize,theme:"#337ab7",curr:currentIndex+1,jump:function(a,b){console.log(a.curr);console.log(a.limit);b||(currentIndex=a.curr-1,doSearch())}}))}else ajaxError(b)},error:function(a){ajaxError(a)}})}function buildUsers(a){for(var b=0;b<a.length;b++)$ContentContainer.append(buildUserEach(a[b]))}function buildUserEach(a){return'\x3cdiv class\x3d"col-lg-12" id\x3d"message-list-content"\x3e\x3cdiv class\x3d"row notification-list notification-list-padding" data-id\x3d""\x3e\x3cdiv class\x3d"col-lg-1 col-md-1 col-sm-2 col-xs-2" style\x3d"text-align: center;"\x3e\x3cimg src\x3d"'+a.user_pic_path+'" width\x3d"60" height\x3d"60" class\x3d"img-rounded" /\x3e\x3c/div\x3e\x3cdiv class\x3d"col-lg-11 col-md-11 col-sm-10 col-xs-10"\x3e\x3cdiv class\x3d"list-group"\x3e\x3cdiv class\x3d"list-group-item notification-list-item active"\x3e\x3ca href\x3d"JavaScript:void(0);" onclick\x3d"linkToMy('+a.id+')" target\x3d"_blank" class\x3d"marginRight"\x3e'+changeNotNullString(a.account)+'\x3c/a\x3e\x3cspan class\x3d"badge"\x3e\u7ba1\u7406\u5458\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"list-group-item notification-list-item"\x3e\x3ctable class\x3d"table table-hover"\x3e\x3ccaption\x3e\u57fa\u672c\u4fe1\u606f\x3c/caption\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\u6027\u522b\x3c/td\x3e\x3ctd\x3e'+changeNotNullString(a.sex)+"\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\u4e2d\u6587\u540d\x3c/td\x3e\x3ctd\x3e"+changeNotNullString(a.china_name)+"\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\u51fa\u751f\u65e5\u671f\x3c/td\x3e\x3ctd\x3e"+changeNotNullString(a.birth_day)+"\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3eqq\x3c/td\x3e\x3ctd\x3e"+changeNotNullString(a.qq)+"\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\u624b\u673a\u53f7\u7801\x3c/td\x3e\x3ctd\x3e"+changeNotNullString(a.mobile_phone)+"\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\u90ae\u7bb1\x3c/td\x3e\x3ctd\x3e"+changeNotNullString(a.email)+"\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\u5b66\u5386\x3c/td\x3e\x3ctd\x3e"+changeNotNullString(a.education_background)+"\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\u6ce8\u518c\u65f6\u95f4\x3c/td\x3e\x3ctd\x3e"+changeNotNullString(a.register_time)+"\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\u7b80\u4ecb\x3c/td\x3e\x3ctd\x3e"+changeNotNullString(a.personal_introduction)+"\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\u6700\u540e\u8bf7\u6c42\u65f6\u95f4\x3c/td\x3e\x3ctd\x3e"+changeNotNullString(a.last_request_time)+"\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"}function buildBlogs(a){for(var b=0;b<a.length;b++)$ContentContainer.append(buildBlogEach(a[b]))}function buildBlogEach(a){return'\x3cdiv class\x3d"col-lg-12" id\x3d"message-list-content"\x3e\x3cdiv class\x3d"row notification-list notification-list-padding" data-id\x3d""\x3e\x3cdiv class\x3d"col-lg-1 col-md-1 col-sm-2 col-xs-2" style\x3d"text-align: center;"\x3e\x3cimg src\x3d"'+a.user_pic_path+'" width\x3d"40" height\x3d"40" class\x3d"img-rounded" /\x3e\x3c/div\x3e\x3cdiv class\x3d"col-lg-11 col-md-11 col-sm-10 col-xs-10"\x3e\x3cdiv class\x3d"list-group"\x3e\x3cdiv class\x3d"list-group-item notification-list-item active"\x3e\x3ca href\x3d"JavaScript:void(0);" onclick\x3d"linkToMy('+a.create_user_id+')" target\x3d"_blank" class\x3d"marginRight"\x3e'+a.account+'\x3c/a\x3e\x3cspan class\x3d"marginRight publish-time"\x3e\u53d1\u5e03\u4e8e: '+a.modify_time+'\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"list-group-item notification-list-item"\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col-lg-12"\x3e\x3ch4\x3e'+a.title+'\x3c/h4\x3e\x3c/div\x3e\x3cdiv class\x3d"col-lg-12 hand" onclick\x3d"linkToTable(122)"\x3e\x3cblockquote\x3e\x3csmall\x3e'+a.digest+'\x3c/small\x3e\x3c/blockquote\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"list-group-item notification-list-item"\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col-lg-12 col-sm-12 col-md-12 col-xs-12 text-align-right"\x3e\x3cbutton class\x3d"btn btn-sm btn-primary pull-right tag-read-btn" onclick\x3d"goToReadFull('+a.id+')" style\x3d"width: 80px;" type\x3d"button"\x3e\u67e5\u770b\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'}function buildMoods(a){for(var b=0;b<a.length;b++)$ContentContainer.append(buildMoodEach(b,a[b]))}function buildMoodEach(a,b){var c='\x3cdiv class\x3d"col-lg-12" id\x3d"message-list-content"\x3e\x3cdiv class\x3d"row notification-list notification-list-padding" data-id\x3d""\x3e\x3cdiv class\x3d"col-lg-1 col-md-1 col-sm-2 col-xs-2" style\x3d"text-align: center;"\x3e\x3cimg src\x3d"'+b.user_pic_path+'" width\x3d"40" height\x3d"40" class\x3d"img-rounded" /\x3e\x3c/div\x3e\x3cdiv class\x3d"col-lg-11 col-md-11 col-sm-10 col-xs-10"\x3e\x3cdiv class\x3d"list-group"\x3e\x3cdiv class\x3d"list-group-item notification-list-item active"\x3e\x3ca href\x3d"JavaScript:void(0);" onclick\x3d"linkToMy('+b.create_user_id+')" target\x3d"_blank" class\x3d"marginRight"\x3e'+changeNotNullString(b.account)+'\x3c/a\x3e\x3cspan class\x3d"marginRight publish-time"\x3e\u53d1\u5e03\u4e8e: '+b.modify_time+'\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"list-group-item notification-list-item"\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col-lg-12"\x3e\x3ch4\x3e'+changeNotNullString(b.content)+'\x3c/h4\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"list-group-item notification-list-item"\x3e\x3cdiv class\x3d"row" style\x3d"margin-top: 5px;"\x3e';if(isNotEmpty(b.imgs))for(var e=b.imgs.split(";"),d=0;d<e.length;d++)c+='\x3cdiv class\x3d"col-lg-4 col-sm-4"\x3e\x3cimg src\x3d"'+e[d]+'" width\x3d"100%" height\x3d"180px" class\x3d"img-rounded" onclick\x3d"showImg(0, 0);" /\x3e\x3c/div\x3e';return c+='\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"list-group-item notification-list-item"\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col-lg-12 col-sm-12 col-md-12 col-xs-12 text-align-right"\x3e\x3cbutton class\x3d"btn btn-sm btn-primary pull-right tag-read-btn" onclick\x3d"goToReadMoodFull('+b.id+","+b.create_user_id+')" style\x3d"width: 80px;" type\x3d"button"\x3e\u67e5\u770b\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'}function buildLogs(a){for(var b=0;b<a.length;b++)$ContentContainer.append(buildLogEach(a[b]))}function buildLogEach(a){return'\x3cdiv class\x3d"col-lg-12" id\x3d"message-list-content"\x3e\x3cdiv class\x3d"row notification-list notification-list-padding" data-id\x3d""\x3e\x3cdiv class\x3d"col-lg-12 col-md-12 col-sm-12 col-xs-12"\x3e\x3cdiv class\x3d"list-group"\x3e\x3cdiv class\x3d"list-group-item notification-list-item active"\x3e\x3ca href\x3d"JavaScript:void(0);" onclick\x3d"linkToMy('+a.create_user_id+')" target\x3d"_blank" class\x3d"marginRight"\x3e'+changeNotNullString(a.account)+'\x3c/a\x3e\x3cspan class\x3d"marginRight publish-time"\x3e\u64cd\u4f5c\u65f6\u95f4: '+a.modify_time+'\x3c/span\x3e\x3cspan class\x3d"publish-time"\x3e\u64cd\u4f5c\u7c7b\u578b\uff1a'+a.operate_type+'\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"list-group-item notification-list-item"\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col-lg-12"\x3e\x3ch4\x3e'+a.subject+'\x3c/h4\x3e\x3c/div\x3e\x3cdiv class\x3d"col-lg-12 hand" onclick\x3d"linkToTable(122)"\x3e\x3cblockquote\x3e\x3cspan\x3eip: '+changeNotNullString(a.ip)+"\x3c/span\x3e\x3cspan\x3e\x26nbsp;\x26nbsp;\u6765\u81ea: "+changeNotNullString(a.location)+"\x3c/span\x3e\x3csmall\x3e\u6d4f\u89c8\u5668\u4fe1\u606f\uff1a "+changeNotNullString(a.browser)+"\x3c/small\x3e\x3c/blockquote\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"};