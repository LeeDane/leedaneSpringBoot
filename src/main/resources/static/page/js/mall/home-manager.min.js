var $categoryListContainer,alreadyData,noData,currentItemIndex=0;layui.use(["layer","form","element"],function(){layer=layui.layer;form=layui.form;$carouselContainer=$("#carousel-container");$shopContainer=$("#shop-container");$categoryListContainer=$("#categoryListContainer");form.on("select(categorys-filter)",function(b){console.log(b.elem);getMallHomeCategory(b.value)});$(".layui-tab-close").unbind("click");$(".layui-tab-close").on("click",function(b){event.preventDefault();event.stopPropagation();var c=$(this),a=c.closest("li").attr("lay-id");layer.confirm("\u786e\u5b9a\u8981\u5728\u9996\u9875\u79fb\u9664\u5206\u7c7b\u5417\uff1f\u5c06\u540c\u65f6\u6e05\u7a7a\u8be5\u5206\u7c7b\u4e0b\u9762\u5173\u8054\u7684\u5b50\u5206\u7c7b\u4ee5\u53ca\u5546\u54c1\u5217\u8868\uff0c\u6b64\u662f\u4e0d\u53ef\u9006\u884c\u4e3a\uff0c\u8bf7\u614e\u91cd\uff01",function(b){var d=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"DELETE",url:"/mall/home/item/"+a,dataType:"json",success:function(a){layer.close(d);a.isSuccess?(a=c.closest("li").attr("lay-id"),element.tabDelete("categoryListFilter",a),layer.closeAll()):ajaxError(a)},error:function(a){ajaxError(a)}})})});getMallHomeCategory($categoryListContainer.find(".layui-this").eq(0).attr("lay-id"));getCarousels();getShops();element.on("tab(categoryListFilter)",function(b){var c=$(b.elem.context).attr("lay-id");currentItemIndex=b.index;getMallHomeCategory(c);return!1});$(document).on("click",".already-allot-item",function(b){index=$(".already-allot-item").index($(this));b=alreadyData[index];$("#no-allot").append('\x3cspan class\x3d"layui-badge no-allot-item hand" style\x3d"margin-top: 5px; margin-right: 5px;"\x3e'+b.value+"\x3c/span\x3e");noData.push(b);alreadyData.splice(index,1);$(this).remove()});$(document).on("click",".no-allot-item",function(b){index=$(".no-allot-item").index($(this));b=noData[index];$("#already-allot").append('\x3cspan class\x3d"layui-badge layui-bg-orange already-allot-item hand" style\x3d"margin-top: 5px; margin-right: 5px;"\x3e'+b.value+"\x3c/span\x3e");alreadyData.push(b);noData.splice(index,1);$(this).remove()})});var $carouselContainer;function getCarousels(){var b=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"get",url:"/mall/home/carousels",dataType:"json",beforeSend:function(){$carouselContainer.empty()},success:function(c){layer.close(b);if(c.isSuccess&&c.message){if(null!=c.message.homeCarouselBeans&&0!=c.message.homeCarouselBeans.length)for(var a=0;a<c.message.homeCarouselBeans.length;a++)buildEachCarouselRow(a,c.message.homeCarouselBeans[a])}else ajaxError(c)},error:function(c){layer.close(b);ajaxError(c)}})}function buildEachCarouselRow(b,c){var a=c.productBean,a='\x3cdiv class\x3d"layui-col-md2 layui-col-xs12"\x3e\x3cdiv class\x3d"layui-col-md12 layui-col-xs12 m-product-item"\x3e\x3cimg alt\x3d"" src\x3d"'+(isNotEmpty(c.img)?c.img:a.mainImgLinks.split(";")[0])+'" class\x3d"m-product-item-img"/\x3e\t\t\x3cdiv class\x3d"m-product-contrainer"\x3e\x3ca class\x3d"m-product-desc" href\x3d"/mall/product/'+c.productId+'/detail" title\x3d"'+changeNotNullString(a.title)+'"\x3e'+changeNotNullString(a.title)+'\x3c/a\x3e\x3cp style\x3d"text-align: left;"\x3e\x3cspan class\x3d"m-product-price"\x3e\u00a5'+a.price+'\x3c/span\x3e \x3cspan style\x3d"float: right; margin-right: 8px; text-decoration: line-through; font-size: 0.6em;"\x3e\u539f\u4ef7: \u00a5'+a.oldPrice+'\x3c/span\x3e\x3c/p\x3e\x3cp style\x3d"text-align: left;"\x3e\x3cspan class\x3d"m-product-price" style\x3d"font-size: 1.0em;"\x3e\u6bd4\u7387\uff1a'+a.cashBackRatio+'%\x3c/span\x3e\x26nbsp;\x26nbsp;\x3cspan style\x3d"float: right; margin-right: 8px; font-size: 1.0em;"\x3e\u4f63\u91d1: \u00a5'+(a.price*a.cashBackRatio/100).toFixed(2)+'\x3c/span\x3e\x3c/p\x3e\x3cp\x3e\x3cbutton class\x3d"layui-btn layui-btn-danger" style\x3d"height: 30px; line-height: 30px; margin-top: 5px;" onclick\x3d"deleteCarousel(this, '+c.id+');"\x3e\u5220\u9664\x3c/button\x3e\x3c/p\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e';$carouselContainer.append(a)}function deleteCarousel(b,c){layer.confirm("\u786e\u5b9a\u8981\u79fb\u9664\u8f6e\u64ad\u5c55\u793a\u7684\u5546\u54c1\u5417\uff1f\u6b64\u662f\u4e0d\u53ef\u9006\u884c\u4e3a\uff0c\u8bf7\u614e\u91cd\uff01",function(a){var b=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"DELETE",url:"/mall/home/carousel/"+c,dataType:"json",beforeSend:function(){},success:function(a){layer.close(b);a.isSuccess?(layer.msg(a.message+"\uff0c1\u79d2\u540e\u5c06\u81ea\u52a8\u5237\u65b0"),reloadPage(1E3)):ajaxError(a)},error:function(a){layer.close(b);ajaxError(a)}})})}function addCarousel(b){console.log(b);var c=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"POST",data:{product_id:b.id,order:1},url:"/mall/home/carousel",dataType:"json",beforeSend:function(){},success:function(a){layer.close(c);a.isSuccess?(layer.msg(a.message+"\uff0c1\u79d2\u540e\u5c06\u81ea\u52a8\u5237\u65b0"),reloadPage(1E3)):ajaxError(a)},error:function(a){layer.close(c);ajaxError(a)}})}var $shopContainer;function addShop(b){console.log(b);var c=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"POST",data:{shop_id:b.id,shop_order:1},url:"/mall/home/shop",dataType:"json",beforeSend:function(){},success:function(a){layer.close(c);a.isSuccess?(layer.msg(a.message+"\uff0c1\u79d2\u540e\u5c06\u81ea\u52a8\u5237\u65b0"),reloadPage(1E3)):ajaxError(a)},error:function(a){layer.close(c);ajaxError(a)}})}function getShops(){var b=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({url:"/mall/home/shops",dataType:"json",beforeSend:function(){$shopContainer.empty()},success:function(c){layer.close(b);if(c.isSuccess&&c.message){if(null!=c.message.homeShopBeans&&0!=c.message.homeShopBeans.length)for(var a=0;a<c.message.homeShopBeans.length;a++)buildEachShopRow(a,c.message.homeShopBeans[a])}else ajaxError(c)},error:function(c){layer.close(b);ajaxError(c)}})}function buildEachShopRow(b,c){var a=c.shopBean,a='\x3cdiv class\x3d"layui-col-md2 layui-col-xs12"\x3e\x3cdiv class\x3d"layui-col-md12 layui-col-xs12 m-product-item"\x3e\x3cimg alt\x3d"" src\x3d"'+changeNotNullString(a.img)+'" class\x3d"m-product-item-img"/\x3e\t\t\x3cdiv class\x3d"m-product-contrainer"\x3e\x3ca class\x3d"m-product-desc" href\x3d"/mall/shop/'+a.id+'/detail" title\x3d"'+changeNotNullString(a.name)+'"\x3e'+changeNotNullString(a.name)+'\x3c/a\x3e\x3cp\x3e\x3cbutton class\x3d"layui-btn layui-btn-danger" style\x3d"height: 30px; line-height: 30px; margin-top: 5px;" onclick\x3d"deleteShop(this, '+c.id+');"\x3e\u5220\u9664\x3c/button\x3e\x3c/p\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e';$shopContainer.append(a)}function deleteShop(b,c){layer.confirm("\u786e\u5b9a\u8981\u79fb\u9664\u8be5\u5546\u5e97\u5417\uff1f\u6b64\u662f\u4e0d\u53ef\u9006\u884c\u4e3a\uff0c\u8bf7\u614e\u91cd\uff01",function(a){var b=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"DELETE",url:"/mall/home/shop/"+c,dataType:"json",beforeSend:function(){},success:function(a){layer.close(b);a.isSuccess?(layer.msg(a.message+"\uff0c1\u79d2\u540e\u5c06\u81ea\u52a8\u5237\u65b0"),reloadPage(1E3)):ajaxError(a)},error:function(a){layer.close(b);ajaxError(a)}})})}function addItem(){var b=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"GET",url:"/mall/home/item/noList?t\x3d"+Math.random(),dataType:"json",beforeSend:function(){},success:function(c){layer.close(b);c.isSuccess&&c.message.no?layer.open({type:1,title:"\u65b0\u589e\u9996\u9875\u5c55\u793a\u7684\u5206\u7c7b",closeBtn:0,shadeClose:!1,skin:"layui-layer-rim",content:buildAddCategoryDiv(c.message.no),scrollbar:!1,success:function(a,c){form.render();form.on("submit(add-category-form-submit)",function(a){a=$(this).closest("form").find('select[name\x3d"new-category"]').val();var c=parseInt($(this).closest("form").find('input[name\x3d"show-number"]').val());if(1>c||10<c)return layer.msg("\u6570\u91cf\u4e0d\u5408\u6cd5\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"),!1;var b=parseInt($(this).closest("form").find('input[name\x3d"show-order"]').val());if(1>b)return layer.msg("\u6392\u5e8f\u8f93\u5165\u4e0d\u5408\u6cd5\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"),!1;var d=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"POST",url:"/mall/home/item",data:{number:c,category_order:b,category_id:a},dataType:"json",success:function(a){layer.close(d);a.isSuccess?(layer.msg(a.message+"\uff0c1\u79d2\u540e\u5c06\u81ea\u52a8\u5237\u65b0"),reloadPage(1E3)):ajaxError(a)},error:function(a){ajaxError(a)}});return!1})}}):ajaxError(c)},error:function(c){layer.close(b);ajaxError(c)}})}function buildAddCategoryDiv(b){for(var c='\x3cdiv\x3e\x3cform class\x3d"layui-form" style\x3d"padding: 10px;"\x3e\x3cdiv class\x3d"layui-form-item"\x3e\x3clabel class\x3d"layui-form-label"\x3e\u9009\u62e9\u5206\u7c7b\x3c/label\x3e\x3cdiv class\x3d"layui-input-inline"\x3e\x3cselect lay-search\x3d"" name\x3d"new-category"\x3e',a=0;a<b.length;a++)c+='\x3coption value\x3d"'+b[a].key+'" text\x3d"'+b[a].value+'"\x3e'+b[a].value+"\x3c/option\x3e";return c+'\x3c/select\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"layui-form-item"\x3e\x3clabel class\x3d"layui-form-label"\x3e\u5c55\u793a\u6570\u91cf\x3c/label\x3e\x3cdiv class\x3d"layui-input-block"\x3e\x3cinput type\x3d"number" value\x3d"1"  name\x3d"show-number"  min\x3d"1" max\x3d"10" step\x3d"1" lay-verify\x3d"required|number" autocomplete\x3d"off" placeholder\x3d"\u8bf7\u8f93\u5165\u5927\u4e8e0\u5c0f\u4e8e11\u7684\u6574\u6570" class\x3d"layui-input"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"layui-form-item"\x3e\x3clabel class\x3d"layui-form-label"\x3e\u5c55\u4f4d\u6392\u5e8f\x3c/label\x3e\x3cdiv class\x3d"layui-input-block"\x3e\x3cinput type\x3d"number" value\x3d"1"  name\x3d"show-order"  min\x3d"1" step\x3d"1" lay-verify\x3d"required|number" autocomplete\x3d"off" placeholder\x3d"\u8bf7\u8f93\u5165\u5927\u4e8e0\u7684\u6574\u6570" class\x3d"layui-input"\x3e\x3c/div\x3e\x3c/div\x3e\x3cbutton style\x3d"float: right; margin-right: 5px; margin-bottom: 5px;" class\x3d"layui-btn layui-btn-small" lay-submit\x3d"" lay-filter\x3d"add-category-form-submit" title\x3d"\u63d0\u4ea4"\x3e\u7acb\u5373\u63d0\u4ea4\x3c/button\x3e\x3cbutton style\x3d"float: right; margin-right: 5px; margin-bottom: 5px;" class\x3d"layui-btn layui-btn-small layui-btn-primary" title\x3d"\u53d6\u6d88" onclick\x3d"cancelCategory();"\x3e\u53d6\u6d88\x3c/button\x3e\x3c/form\x3e\x3c/div\x3e'}function addCategorySubmit(b){}function getMallHomeCategory(b){$categoryListContainer.find(".layui-show").find("#sunCategoryContainer").find(".layui-badge").remove();var c=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"GET",url:"/mall/home/item/"+b+"?t\x3d"+Math.random(),dataType:"json",beforeSend:function(){},success:function(a){layer.close(c);if(a.isSuccess){if(a.message){var b="\x3cdiv\x3e\u5c55\u793a\u7684\u6570\u91cf\uff1a \x3cspan\x3e"+a.message.number+'\x3ci class\x3d"layui-icon hand" onclick\x3d"updateItemNumber(this, '+a.message.number+", "+a.message.itemId+');" style\x3d"font-size: 15px; color: #1E9FFF;"\x3e\x26#xe642;\x3c/i\x3e\x3c/span\x3e\x3c/div\x3e\x3cdiv\x3e\u6392\u5e8f\u53f7\uff1a \x3cspan\x3e'+a.message.order+'\x3ci class\x3d"layui-icon hand" onclick\x3d"updateItemOrder(this, '+a.message.order+", "+a.message.itemId+');" style\x3d"font-size: 15px; color: #1E9FFF;"\x3e\x26#xe642;\x3c/i\x3e\x3c/span\x3e\x3c/div\x3e';$categoryListContainer.find(".layui-show").find("#baseInfoCategory").html(b);appendChildren(a.message.childrens);appendProducts(a.message.productBeans)}}else ajaxError(a),$categoryListContainer.find(".layui-tab-item").eq(currentItemIndex).html("\u83b7\u53d6\u9519\u8bef")},error:function(a){layer.close(c);ajaxError(a)}})}function updateItemNumber(b,c,a){layer.open({type:1,title:"\u4fee\u6539\u663e\u793a\u6570\u91cf",closeBtn:0,shadeClose:!1,skin:"yourclass",content:'\x3cinput class\x3d"update-item-input-style" type\x3d"number" value\x3d"1" min\x3d"1" max\x3d"10" step\x3d"1" lay-verify\x3d"required|number" autocomplete\x3d"off" placeholder\x3d"\u8bf7\u8f93\u5165\u5927\u4e8e0\u5c0f\u4e8e11\u7684\u6574\u6570"\x3e\x3c/input\x3e\x3cdiv\x3e\x3cbutton style\x3d"float: right; margin-right: 5px; margin-bottom: 5px;" class\x3d"layui-btn layui-btn-small" title\x3d"\u63d0\u4ea4" onclick\x3d"submitUpdateItemNumber(this, '+a+');"\x3e\u7acb\u5373\u63d0\u4ea4\x3c/button\x3e\x3cbutton style\x3d"float: right; margin-right: 5px; margin-bottom: 5px;" class\x3d"layui-btn layui-btn-small layui-btn-primary" title\x3d"\u53d6\u6d88" onclick\x3d"cancelCategory();"\x3e\u53d6\u6d88\x3c/button\x3e\x3c/div\x3e'})}function submitUpdateItemNumber(b,c){var a=$(b).closest(".layui-layer-content").find("input").val();if(1>a||10<a)return layer.msg("\u6570\u91cf\u4e0d\u5408\u6cd5\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"),!1;var d=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"PUT",data:{number:a},url:"/mall/home/item/"+c,dataType:"json",beforeSend:function(){},success:function(a){layer.close(d);a.isSuccess?a.message&&(layer.closeAll(),layer.msg(a.message+"\uff0c1\u79d2\u540e\u5c06\u81ea\u52a8\u5237\u65b0"),reloadPage(1E3)):ajaxError(a)},error:function(a){layer.close(d);ajaxError(a)}})}function updateItemOrder(b,c,a){layer.open({type:1,title:"\u4fee\u6539\u663e\u793a\u6392\u5e8f",closeBtn:0,shadeClose:!1,skin:"yourclass",content:'\x3cinput class\x3d"update-item-input-style" type\x3d"number" value\x3d"1" min\x3d"1" max\x3d"10" step\x3d"1" lay-verify\x3d"required|number" placeholder\x3d"\u8bf7\u8f93\u5165\u5927\u4e8e0\u7684\u6574\u6570"\x3e\x3c/input\x3e\x3cdiv\x3e\x3cbutton style\x3d"float: right; margin-right: 5px; margin-bottom: 5px;" class\x3d"layui-btn layui-btn-small" title\x3d"\u63d0\u4ea4" onclick\x3d"submitUpdateItemOrder(this, '+a+');"\x3e\u7acb\u5373\u63d0\u4ea4\x3c/button\x3e\x3cbutton style\x3d"float: right; margin-right: 5px; margin-bottom: 5px;" class\x3d"layui-btn layui-btn-small layui-btn-primary" title\x3d"\u53d6\u6d88" onclick\x3d"cancelCategory();"\x3e\u53d6\u6d88\x3c/button\x3e\x3c/div\x3e'})}function submitUpdateItemOrder(b,c){var a=$(b).closest(".layui-layer-content").find("input").val();if(1>a)return layer.msg("\u6392\u5e8f\u8f93\u5165\u4e0d\u5408\u6cd5\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"),!1;var d=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"PUT",data:{order:a},url:"/mall/home/item/"+c,dataType:"json",beforeSend:function(){},success:function(a){layer.close(d);a.isSuccess?a.message&&(layer.closeAll(),layer.msg(a.message+"\uff0c1\u79d2\u540e\u5c06\u81ea\u52a8\u5237\u65b0"),reloadPage(1E3)):ajaxError(a)},error:function(a){layer.close(d);ajaxError(a)}})}function appendChildren(b){var c="";if(b)for(var a=0;a<b.length;a++)c+='\x3cspan class\x3d"layui-badge layui-bg-orange" style\x3d"margin-top: 5px; margin-right: 5px;"\x3e'+b[a].value+"\x3c/span\x3e";$categoryListContainer.find(".layui-show").find("#sunCategoryContainer").append(c)}function appendProducts(b){var c="";$categoryListContainer.find(".layui-show").find("#productListShow").empty();if(b)for(var a=0;a<b.length;a++)var d=b[a].productBean,c=c+('\x3cdiv class\x3d"layui-col-md2 layui-col-xs12"\x3e\x3cdiv class\x3d"layui-col-md12 layui-col-xs12 m-product-item"\x3e\x3cimg alt\x3d"" src\x3d"'+d.mainImgLinks.split(";")[0]+'" class\x3d"m-product-item-img"/\x3e\t\t\x3cdiv class\x3d"m-product-contrainer"\x3e\x3ca class\x3d"m-product-desc" href\x3d"/mall/product/'+d.id+'/detail" title\x3d"'+changeNotNullString(d.title)+'"\x3e'+changeNotNullString(d.title)+'\x3c/a\x3e\x3cp style\x3d"text-align: left;"\x3e\x3cspan class\x3d"m-product-price"\x3e\u00a5'+d.price+'\x3c/span\x3e \x3cspan style\x3d"float: right; margin-right: 8px; text-decoration: line-through; font-size: 0.6em;"\x3e\u539f\u4ef7: \u00a5'+d.oldPrice+'\x3c/span\x3e\x3c/p\x3e\x3cp style\x3d"text-align: left;"\x3e\x3cspan class\x3d"m-product-price" style\x3d"font-size: 1.0em;"\x3e\u6bd4\u7387\uff1a'+d.cashBackRatio+'%\x3c/span\x3e\x26nbsp;\x26nbsp;\x3cspan style\x3d"float: right; margin-right: 8px; font-size: 1.0em;"\x3e\u4f63\u91d1: \u00a5'+(d.price*d.cashBackRatio/100).toFixed(2)+'\x3c/span\x3e\x3c/p\x3e\x3cp\x3e\x3cbutton class\x3d"layui-btn layui-btn-danger" style\x3d"height: 30px; line-height: 30px; margin-top: 5px;" onclick\x3d"deleteItemProduct(this, '+b[a].itemId+" , "+b[a].id+');"\x3e\u5220\u9664\x3c/button\x3e\x3c/p\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e');$categoryListContainer.find(".layui-show").find("#productListShow").append(c)}function manageCategory(b){var c=$(b).closest(".layui-tab-item").attr("data-id"),a=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"GET",url:"/mall/home/item/"+c+"/matching?t\x3d"+Math.random(),dataType:"json",beforeSend:function(){},success:function(b){layer.close(a);b.isSuccess?layer.open({type:1,title:"\u5b50\u5206\u7c7b\u7684\u7ba1\u7406",closeBtn:0,shadeClose:!1,skin:"yourclass",content:buildChilderCategoryManageDiv(b.message,c)}):ajaxError(b)},error:function(b){layer.close(a);ajaxError(b)}})}function buildChilderCategoryManageDiv(b,c){alreadyData=b.already;noData=b.no;for(var a='\x3cdiv\x3e\x3cfieldset class\x3d"layui-elem-field"\x3e\x3clegend\x3e\u5df2\u7ecf\u5206\u914d\u7684\u5206\u7c7b(\u70b9\u51fb\u5220\u9664)\x3c/legend\x3e\x3cdiv class\x3d"layui-field-box" id\x3d"already-allot"\x3e',d=0;d<b.already.length;d++)a+='\x3cspan class\x3d"layui-badge layui-bg-orange already-allot-item hand" style\x3d"margin-top: 5px; margin-right: 5px;"\x3e'+b.already[d].value+"\x3c/span\x3e";a+=' \x3c/div\x3e\x3c/fieldset\x3e\x3cfieldset class\x3d"layui-elem-field"\x3e\x3clegend\x3e\u672a\u5206\u914d\u7684\u5206\u7c7b(\u70b9\u51fb\u6dfb\u52a0)\x3c/legend\x3e\x3cdiv class\x3d"layui-field-box" id\x3d"no-allot"\x3e';for(d=0;d<b.no.length;d++)a+='\x3cspan class\x3d"layui-badge no-allot-item hand" style\x3d"margin-top: 5px; margin-right: 5px;"\x3e'+b.no[d].value+"\x3c/span\x3e";return a+(' \x3c/div\x3e\x3c/fieldset\x3e\x3c/div\x3e\x3cdiv\x3e\x3cbutton style\x3d"float: right; margin-right: 5px; margin-bottom: 5px;" class\x3d"layui-btn layui-btn-small" title\x3d"\u63d0\u4ea4" onclick\x3d"submitCategory('+c+');"\x3e\u7acb\u5373\u63d0\u4ea4\x3c/button\x3e\x3cbutton style\x3d"float: right; margin-right: 5px; margin-bottom: 5px;" class\x3d"layui-btn layui-btn-small layui-btn-primary" title\x3d"\u53d6\u6d88" onclick\x3d"cancelCategory();"\x3e\u53d6\u6d88\x3c/button\x3e\x3c/div\x3e')}function submitCategory(b){for(var c=0;c<alreadyData.length;c++);var a=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"PUT",url:"/mall/home/item/"+b+"/category",data:{data:JSON.stringify(alreadyData)},dataType:"json",beforeSend:function(){},success:function(b){layer.close(a);b.isSuccess?(layer.closeAll(),layer.msg(b.message+"\uff0c1\u79d2\u540e\u5c06\u81ea\u52a8\u5237\u65b0"),reloadPage(1E3)):ajaxError(b)},error:function(b){layer.close(a);ajaxError(b)}})}function cancelCategory(){layer.closeAll()}function manageProduct(b){var c=$(b).closest(".layui-tab-item").attr("data-id"),a=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"GET",url:"/mall/home/item/"+c+"/products",dataType:"json",beforeSend:function(){},success:function(b){layer.close(a);b.isSuccess?layer.open({type:1,title:!1,closeBtn:0,shadeClose:!1,skin:"yourclass",content:buildChilderCategoryManageDiv(b.message,c)}):ajaxError(b)},error:function(b){layer.close(a);ajaxError(b)}})}function getItemProduct(b){console.log(b);var c=$categoryListContainer.find(".layui-this").attr("lay-id"),a=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"POST",data:{product_id:b.id},url:"/mall/home/item/"+c+"/product",dataType:"json",beforeSend:function(){},success:function(b){layer.close(a);b.isSuccess?(layer.msg(b.message+"\uff0c1\u79d2\u540e\u5c06\u81ea\u52a8\u5237\u65b0"),reloadPage(1E3)):ajaxError(b)},error:function(b){layer.close(a);ajaxError(b)}})}function deleteItemProduct(b,c,a){layer.confirm("\u786e\u5b9a\u8981\u79fb\u9664\u8be5\u9879\u7684\u5546\u54c1\u5417\uff1f\u6b64\u662f\u4e0d\u53ef\u9006\u884c\u4e3a\uff0c\u8bf7\u614e\u91cd\uff01",function(b){var d=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"DELETE",url:"/mall/home/item/"+c+"/product/"+a,dataType:"json",beforeSend:function(){},success:function(a){layer.close(d);a.isSuccess?(layer.msg(a.message+"\uff0c1\u79d2\u540e\u5c06\u81ea\u52a8\u5237\u65b0"),reloadPage(1E3)):ajaxError(a)},error:function(a){layer.close(d);ajaxError(a)}})})};