var carousel,$itemsContainer,$brandsContainer;layui.use(["layer","carousel","element"],function(){layer=layui.layer;carousel=layui.carousel;element=layui.element;$carouselContainer=$("#carousel-container");$itemsContainer=$("#items-container");$brandsContainer=$("#brands-container");getCarouselImgs();getShops();getItems()});var $carouselContainer;function getCarouselImgs(){$.ajax({url:"/mall/home/carousels?t\x3d"+Math.random(),beforeSend:function(){},success:function(b){$carouselContainer.empty();if(null!=b&&b.isSuccess)if(b=b.message.homeCarouselBeans,0<b.length){var a,d;$carouselContainer.append('\x3cdiv carousel-item\x3d"" id\x3d"carousel-item"\x3e\x3c/div\x3e');for(var c=0;c<b.length;c++)a=b[c].productBean,d=b[c],a='\x3cdiv\x3e\x3cimg style\x3d"width: 100%; cursor: pointer;" src\x3d"'+(isNotEmpty(d.img)?d.img:a.mainImgLinks.split(";")[0])+'" onclick\x3d"linkToProduct('+d.productId+')" /\x3e\x3c/div\x3e',$("#carousel-item").append(a);carousel.render({elem:"#carousel-container",width:"100%",height:"340px",interval:3E3})}else $carouselContainer.remove();else $carouselContainer.remove(),ajaxError(b)},error:function(b){ajaxError(b)}})}function getItems(){$.ajax({url:"/mall/home/items?t\x3d"+Math.random(),beforeSend:function(){},success:function(b){if(null!=b&&b.isSuccess&&b.message){if(0<b.message.length){for(var a=0;a<b.message.length;a++)$itemsContainer.append(itemsEachRow(a,b.message[a]));layui.element.render("breadcrumb")}}else ajaxError(b)},error:function(b){ajaxError(b)}})}function itemsEachRow(b,a){var d=a.productBeans&&0<a.productBeans.length?a.productBeans.length:0,c='\x3cdiv class\x3d"layui-row" desc\x3d"\u670d\u88c5\u8863\u5e3d" style\x3d"margin-top: 10px;"\x3e\x3cdiv class\x3d"layui-col-md12 layui-col-xs12" \x3e\x3cdiv class\x3d"m-title"\x3e'+a.categoryText+'\x3c/div\x3e\x3cdiv class\x3d"m-title-right"\x3e\x3c/div\x3e\x3cspan class\x3d"layui-breadcrumb m-title-nav" lay-separator\x3d"|"\x3e';if(a.childrens&&0<a.childrens.length)for(var e=0;e<a.childrens.length;e++)c+='\x3ca href\x3d"/mall/category/'+a.childrens[e].key+'"\x3e'+a.childrens[e].value+"\x3c/a\x3e";c+="\x3c/span\x3e\x3c/div\x3e";0<d&&(c+='\x3cdiv class\x3d"layui-col-md3 layui-col-xs12" style\x3d"text-align:center; height:320px; cursor: pointer;  background: url(\''+a.productBeans[0].productBean.mainImgLinks.split(";")[0]+'\') no-repeat; background-size:100% 100%;" onclick\x3d"linkToProduct('+a.productBeans[0].productBean.id+');"\x3e\x3cp style\x3d"position: absolute; top: 100px; background-color: #000;  filter:Alpha(opacity\x3d0.1); color: #fff;"\x3e'+a.productBeans[0].productBean.title+'\x3c/p\x3e\x3cimg alt\x3d"" src\x3d"/page/images/icon_right.png" width\x3d"30" height\x3d"30" style\x3d"position: absolute; bottom: 10px; right: 10px;"/\x3e\x3c/div\x3e');1<d&&(c+='\x3cdiv class\x3d"layui-col-md9 layui-col-xs12 m-item-contrainer" style\x3d"text-align:right; vertical-align:right; "\x3e\x3cdiv class\x3d"layui-col-md12 layui-col-xs12" style\x3d"background-color: #fff;"\x3e\x3cdiv class\x3d"layui-col-md4 layui-col-xs12 m-product-item m-border-top m-border-left" onclick\x3d"linkToProduct('+a.productBeans[1].productBean.id+');"\x3e\x3cimg alt\x3d"" src\x3d"'+a.productBeans[1].productBean.mainImgLinks.split(";")[0]+'" class\x3d"m-product-item-img"/\x3e\x3cdiv class\x3d"m-product-contrainer"\x3e\x3ca class\x3d"m-product-desc" title\x3d"'+a.productBeans[1].productBean.title+'"\x3e'+a.productBeans[1].productBean.title+'\x3c/a\x3e\x3cp\x3e\x3cspan class\x3d"m-product-price"\x3e\u00a5'+a.productBeans[1].productBean.price+'\x3c/span\x3e \x3cspan style\x3d"text-decoration: line-through; font-size: 0.6em;"\x3e\u539f\u4ef7: \u00a5'+a.productBeans[1].productBean.oldPrice+"\x3c/span\x3e\x3c/p\x3e\x3c/div\x3e\x3c/div\x3e",2<d&&(c+='\x3cdiv class\x3d"layui-col-md4 layui-col-xs12 m-product-item m-border-top" onclick\x3d"linkToProduct('+a.productBeans[2].productBean.id+');"\x3e\x3cimg alt\x3d"" src\x3d"'+a.productBeans[2].productBean.mainImgLinks.split(";")[0]+'" class\x3d"m-product-item-img"/\x3e\x3cdiv class\x3d"m-product-contrainer"\x3e\x3ca class\x3d"m-product-desc" title\x3d"'+a.productBeans[2].productBean.title+'"\x3e'+a.productBeans[2].productBean.title+'\x3c/a\x3e\x3cp\x3e\x3cspan class\x3d"m-product-price"\x3e\u00a5'+a.productBeans[2].productBean.price+'\x3c/span\x3e \x3cspan style\x3d"text-decoration: line-through; font-size: 0.6em;"\x3e\u539f\u4ef7: \u00a5'+a.productBeans[2].productBean.oldPrice+"\x3c/span\x3e\x3c/p\x3e\x3c/div\x3e\x3c/div\x3e"),3<d&&(c+='\x3cdiv class\x3d"layui-col-md4 layui-col-xs12 m-product-item m-border-top" onclick\x3d"linkToProduct('+a.productBeans[3].productBean.id+');"\x3e\x3cimg alt\x3d"" src\x3d"'+a.productBeans[3].productBean.mainImgLinks.split(";")[0]+'" class\x3d"m-product-item-img"/\x3e\x3cdiv class\x3d"m-product-contrainer"\x3e\x3ca class\x3d"m-product-desc" title\x3d"'+a.productBeans[3].productBean.title+'"\x3e'+a.productBeans[3].productBean.title+'\x3c/a\x3e\x3cp\x3e\x3cspan class\x3d"m-product-price"\x3e\u00a5'+a.productBeans[3].productBean.price+'\x3c/span\x3e \x3cspan style\x3d"text-decoration: line-through; font-size: 0.6em;"\x3e\u539f\u4ef7: \u00a5'+a.productBeans[3].productBean.oldPrice+"\x3c/span\x3e\x3c/p\x3e\x3c/div\x3e\x3c/div\x3e"),4<d&&(c+='\x3cdiv class\x3d"layui-col-md4 layui-col-xs12 m-product-item m-border-left m-border-bottom" onclick\x3d"linkToProduct('+a.productBeans[4].productBean.id+');"\x3e\x3cimg alt\x3d"" src\x3d"'+a.productBeans[4].productBean.mainImgLinks.split(";")[0]+'" class\x3d"m-product-item-img"/\x3e\x3cdiv class\x3d"m-product-contrainer"\x3e\x3ca class\x3d"m-product-desc" title\x3d"'+a.productBeans[4].productBean.title+'"\x3e'+a.productBeans[4].productBean.title+'\x3c/a\x3e\x3cp\x3e\x3cspan class\x3d"m-product-price"\x3e\u00a5'+a.productBeans[4].productBean.price+'\x3c/span\x3e \x3cspan style\x3d"text-decoration: line-through; font-size: 0.6em;"\x3e\u539f\u4ef7: \u00a5'+a.productBeans[4].productBean.oldPrice+"\x3c/span\x3e\x3c/p\x3e\x3c/div\x3e\x3c/div\x3e"),5<d&&(c+='\x3cdiv class\x3d"layui-col-md4 layui-col-xs12 m-product-item m-border-bottom" onclick\x3d"linkToProduct('+a.productBeans[5].productBean.id+');"\x3e\x3cimg alt\x3d"" src\x3d"'+a.productBeans[5].productBean.mainImgLinks.split(";")[0]+'" class\x3d"m-product-item-img"/\x3e\x3cdiv class\x3d"m-product-contrainer"\x3e\x3ca class\x3d"m-product-desc" title\x3d"'+a.productBeans[5].productBean.title+'"\x3e'+a.productBeans[5].productBean.title+'\x3c/a\x3e\x3cp\x3e\x3cspan class\x3d"m-product-price"\x3e\u00a5'+a.productBeans[5].productBean.price+'\x3c/span\x3e \x3cspan style\x3d"text-decoration: line-through; font-size: 0.6em;"\x3e\u539f\u4ef7: \u00a5'+a.productBeans[5].productBean.oldPrice+"\x3c/span\x3e\x3c/p\x3e\x3c/div\x3e\x3c/div\x3e"),6<d&&(c+='\x3cdiv class\x3d"layui-col-md4 layui-col-xs12 m-product-item m-border-bottom" onclick\x3d"linkToProduct('+a.productBeans[6].productBean.id+');"\x3e\x3cimg alt\x3d"" src\x3d"'+a.productBeans[6].productBean.mainImgLinks.split(";")[0]+'" class\x3d"m-product-item-img"/\x3e\x3cdiv class\x3d"m-product-contrainer"\x3e\x3ca class\x3d"m-product-desc" title\x3d"'+a.productBeans[6].productBean.title+'"\x3e'+a.productBeans[6].productBean.title+'\x3c/a\x3e\x3cp\x3e\x3cspan class\x3d"m-product-price"\x3e\u00a5'+a.productBeans[6].productBean.price+'\x3c/span\x3e \x3cspan style\x3d"text-decoration: line-through; font-size: 0.6em;"\x3e\u539f\u4ef7: \u00a5'+a.productBeans[6].productBean.oldPrice+"\x3c/span\x3e\x3c/p\x3e\x3c/div\x3e\x3c/div\x3e"),c+="\x3c/div\x3e\x3c/div\x3e");return c+"\x3c/div\x3e"}function getShops(){var b=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({url:"/mall/home/shops?limit\x3d6",dataType:"json",beforeSend:function(){$brandsContainer.empty()},success:function(a){layer.close(b);if(a.isSuccess&&a.message){if(null!=a.message.homeShopBeans&&0!=a.message.homeShopBeans.length){for(var d="",c=0;c<a.message.homeShopBeans.length;c++)d+='\x3cdiv class\x3d"layui-col-md2 layui-col-xs4" style\x3d"text-align:center;"\x3e\x3cimg src\x3d"'+a.message.homeShopBeans[c].shopBean.img+'" onclick\x3d"linkToShop('+a.message.homeShopBeans[c].shopId+');" style\x3d"width: 100%; height: 80px;"/\x3e\x3c/div\x3e';$brandsContainer.append(d)}}else ajaxError(a)},error:function(a){layer.close(b);ajaxError(a)}})}function linkToShop(b){window.open("/mall/shop/"+b,"_blank")};