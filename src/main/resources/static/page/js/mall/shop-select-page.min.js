var layerIndex,$SearchContainer;layui.use(["layer","laypage"],function(){layer=layui.layer;laypage=layui.laypage;$SearchContainer=$("input[name\x3d'shop-search-value']");$shopContainer=$("#shop-row-container")});var shop_pageSize=4,shop_start=0,shop_currentIndex=0,shop_totalPage=0,shops,shop_sort="createTime",shop_sort_desc=!0;function doSearch(){var b=$SearchContainer.val();if(isEmpty(b))layer.msg("\u8bf7\u8f93\u5165\u60a8\u8981\u641c\u7d22\u7684\u5185\u5bb9\uff01"),$SearchContainer.focus();else{var c=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"get",url:"/s/s?"+jsonToGetRequestParams({keyword:b,sort:shop_sort,desc:shop_sort_desc,start:shop_currentIndex*shop_pageSize,current:shop_currentIndex,type:4,rows:shop_pageSize,t:Math.random()}),dataType:"json",beforeSend:function(){},beforeSend:function(){},success:function(a){layer.close(c);$(".search-need-time").text(a.consumeTime);a.success&&isNotEmpty(a.message)?dealShopSearch(a.message[4],a.total):ajaxError(a)},error:function(a){layer.close(c);ajaxError(a)}})}}function dealShopSearch(b,c){$shopContainer.empty();if(0==b.length)0==shop_currentIndex?$shopContainer.append("\u641c\u7d22\u4e0d\u5230\u7b26\u5408\u6761\u4ef6\u7684\u5546\u5e97\uff0c\u8bf7\u6362\u6761\u4ef6\u8bd5\u8bd5\uff01"):$shopContainer.append("\u5df2\u7ecf\u6ca1\u6709\u66f4\u591a\u7684\u5546\u5e97\u5566\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\uff01");else{shops=b;for(var a=0;a<shops.length;a++)buildEachSearchShopRow(a,shops[a])}0!=shop_currentIndex||shops&&0!=shops.length?laypage.render({elem:"shop-pager",layout:["prev","page","next","count","skip"],count:c[5],limit:shop_pageSize,curr:shop_currentIndex+1,jump:function(a,b){console.log(a.curr);console.log(a.limit);b||(shop_currentIndex=a.curr-1,doSearch())}}):$("#shop-pager").empty()}function buildEachSearchShopRow(b,c){var a='\x3cdiv class\x3d"layui-col-md6 layui-col-xs6" onclick\x3d"getSelectShopData('+b+');"\x3e\x3cdiv class\x3d"layui-col-md12 layui-col-xs12 m-product-item"\x3e\x3cimg alt\x3d"" src\x3d"'+c.img+'" class\x3d"m-product-item-img"/\x3e\t\t\x3cdiv class\x3d"m-product-contrainer"\x3e\x3ca class\x3d"m-product-desc" href\x3d"javascript:void(0);" title\x3d"'+changeNotNullString(c.name)+'"\x3e'+changeNotNullString(c.name)+"\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e";$shopContainer.append(a)}function getSelectShopData(b){layerIndex=parent.layer.getFrameIndex(window.name);parent.getSelectShopData(layerIndex,shops[b])};