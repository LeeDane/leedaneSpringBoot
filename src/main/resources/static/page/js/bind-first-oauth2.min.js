/**
** 刷新验证码
*/
function refresh(){$("#captcha_img").attr("src","/kaptcha?"+Math.random())}var bindType=1;function bindTypeCheck(a){a=$(a);a.hasClass("type-register")?(bindType=0,a.html("\u672a\u6709\u8d26\u53f7"),$("#confirm-password").hide(),$("#rg-phone").hide(),a.attr("class","type-login")):(bindType=1,a.html("\u5df2\u6709\u8d26\u53f7"),$("#confirm-password").show(),$("#rg-phone").show(),a.attr("class","type-register"))}function rgRefresh(){$("#rg_captcha_img").attr("src","/kaptcha?"+Math.random())}function doBind(){var a=$("#account").val();if(isEmpty(a))layer.msg("\u8bf7\u8f93\u5165\u8d26\u53f7"),$("#account").focus();else{var b=$("#password").val();if(isEmpty(b))layer.msg("\u8bf7\u8f93\u5165\u5bc6\u7801"),$("#password").focus();else{var d=$("#confirm-password").val();if(1==bindType){if(isEmpty(d)){layer.msg("\u8bf7\u8f93\u5165\u786e\u8ba4\u5bc6\u7801");$("#confirm-password").focus();return}if(d!=b){layer.msg("\u4e24\u6b21\u5bc6\u7801\u8f93\u5165\u4e0d\u5339\u914d");$("#conform-password").focus();return}}var e=$("#rg-phone").val();if(1!=bindType||!isEmpty(e)&&11==e.length){var f=$("#img-code").val();if(isEmpty(f))layer.msg("\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801"),$("#img-code").focus();else{var c=new JSEncrypt;c.setPublicKey($("#publicKey").val());var a=1==bindType?{iparams:$("#params").val(),mobilePhone:c.encrypt(e),account:a,password:c.encrypt($.md5(b)),confirmPassword:c.encrypt($.md5(d)),code:f,t:Math.random()}:{iparams:$("#params").val(),account:a,password:c.encrypt($.md5(b)),code:f,t:Math.random()},g=layer.load("\u52aa\u529b\u52a0\u8f7d\u4e2d\u2026");$.ajax({type:"post",data:a,url:"/oauth2/bind/first",dataType:"json",withCredentials:!0,beforeSend:function(a){},success:function(a){layer.close(g);a.success?(layer.msg(a.message),window.open("/lg","_self")):(layer.close(g),ajaxError(a))},error:function(a){layer.close(g);ajaxError(a)}})}}else layer.msg("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801"),$("#rg-phone").focus()}}}document.onkeydown=function(a){var b=a||window.event||arguments.callee.caller.arguments[0];b&&13==b.keyCode&&doBind()};