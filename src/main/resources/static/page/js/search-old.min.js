layui.use(["layer"],function(){layer=layui.layer;$(".common-search").remove();searchKey=getURLParam(decodeURI(window.location.href),"q");isEmpty(searchKey)?layer.msg("\u83b7\u53d6\u4e0d\u5230\u60a8\u8981\u68c0\u7d22\u7684\u5173\u952e\u5b57\uff01"):($("#common-search-text").val(searchKey),doSearch())});var moods,searchKey;function search(b){b=$("#common-search-text").val();isEmpty(b)?(layer.msg("\u8bf7\u8f93\u5165\u60a8\u8981\u641c\u7d22\u7684\u5185\u5bb9\uff01"),$("#common-search-text").focus()):(searchKey=b,doSearch())}function doSearch(){$.ajax({type:"get",url:"/s/es?keyword\x3d"+searchKey+"\x26t\x3d"+Math.random(),dataType:"json",beforeSend:function(){$("#user-result-show").empty();$("#mood-result-show").empty();$("#blog-result-show").empty();$("#search-user-number").text(0);$("#search-mood-number").text(0);$("#search-blog-number").text(0)},success:function(b){if(b.isSuccess&&isNotEmpty(b.message)){$("#search-need-time").text(b.consumeTime);var a=b.message["1"];isNotEmpty(a)&&($("#search-blog-number").text(a.length),0<a.length&&buildBlogs(a));a=b.message["2"];isNotEmpty(a)&&($("#search-mood-number").text(a.length),0<a.length&&(moods=a,buildMoods(a)));b=b.message["3"];isNotEmpty(b)&&($("#search-user-number").text(b.length),0<b.length&&buildUsers(b))}else ajaxError(b)},error:function(b){ajaxError(b)}})}function buildUsers(b){for(var a=0;a<b.length;a++)$("#user-result-show").append(buildUserEach(b[a]))}function buildUserEach(b){var a='\x3cdiv class\x3d"col-lg-1 col-md-1 col-sm-2 col-xs-2" onclick\x3d"linkToMy('+b.id+')"\x3e',a=isNotEmpty(b.user_pic_path)?a+('\x3cimg class\x3d"img-circle center-block" alt\x3d"" width\x3d"40" height\x3d"40" src\x3d"'+b.user_pic_path+'"\x3e'):a+'\x3cimg class\x3d"img-circle center-block" alt\x3d"" width\x3d"40" height\x3d"40" src\x3d""\x3e';return a+='\x3cdiv class\x3d"user-account cut-text" title\x3d"'+b.account+'"\x3e\x3ca href\x3d"JavaScript:void(0);"\x3e'+b.account+"\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e"}function buildBlogs(b){for(var a=0;a<b.length;a++)$("#blog-result-show").append(buildBlogEach(b[a]))}function buildBlogEach(b){var a='\x3cdiv class\x3d"row blog-list-row"\x3e\x3cdiv class\x3d"col-lg-1 col-md-1 col-sm-2 col-xs-2" style\x3d"text-align: center;margin-top: 10px;"\x3e',a=isNotEmpty(b.imgUrl)?a+('\x3cimg width\x3d"40" height\x3d"40" class\x3d"img-circle hand center-block" alt\x3d"" src\x3d"'+b.imgUrl+'"  onclick\x3d"showSingleImg(this);"/\x3e'):a+'\x3cimg class\x3d"img-circle hand center-block" alt\x3d"" src\x3d""/\x3e',a=a+('\x3c/div\x3e\x3cdiv class\x3d"col-lg-11 col-md-11 col-sm-10 col-xs-10"\x3e\x3cdiv class\x3d"row" style\x3d"font-family: \'\u5fae\u8f6f\u96c5\u9ed1\'; font-size: 15px; margin-top: 10px;"\x3e\x3cdiv class\x3d"col-lg-12"\x3e\x3cspan class\x3d"blog-user-name"\x3e\x3ca href\x3d"JavaScript:void(0);" onclick\x3d"linkToMy('+b.createUserId+')" title\x3d"'+changeNotNullString(b.account)+'"\x3e'+changeNotNullString(b.account)+'\x3c/a\x3e\x3c/span\x3e   \x3cspan class\x3d"blog-create-time"\x3e\x26nbsp;\x26nbsp;'+changeNotNullString(b.createTime)+'\x3c/span\x3e   \x3cspan class\x3d"blog-froms"\x3e\x26nbsp;\x26nbsp;'+changeNotNullString(b.froms)+'\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"row" style\x3d"font-family: \'\u5fae\u8f6f\u96c5\u9ed1\'; font-size: 15px;margin-top: 5px; margin-bottom: 5px;"\x3e\x3cdiv class\x3d"col-lg-12"\x3e'+b.digest+'......\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col-lg-12 col-sm-12"\x3e');if(isNotEmpty(b.tag))for(var c=b.tag.split(","),d=0;d<c.length;d++)0==d&&(a+='\x3cspan class\x3d"label label-default tag" style\x3d"font-size: 13px;"\x3e'+c[d]+"\x3c/span\x3e"),1==d&&(a+='\x3cspan class\x3d"label label-primary tag" style\x3d"font-size: 13px; margin-left: 8px;"\x3e'+c[d]+"\x3c/span\x3e"),2==d&&(a+='\x3cspan class\x3d"label label-success tag" style\x3d"font-size: 13px; margin-left: 8px;"\x3e'+c[d]+"\x3c/span\x3e");return a+='\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"row" style\x3d"font-family: \'\u5b8b\u4f53\'; font-size: 12px;margin-top: 5px; color: gray; margin-bottom: 10px;"\x3e\x3cdiv class\x3d"col-lg-12"\x3e\x3cbutton type\x3d"button" class\x3d"btn btn-primary btn-sm" onclick\x3d"goToReadFull('+b.id+')"\x3e\u67e5\u770b\u8be6\u7ec6\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'}function buildMoods(b){for(var a=0;a<b.length;a++)$("#mood-result-show").append(buildMoodEach(a,b[a]))}function buildMoodEach(b,a){var c='\x3cdiv class\x3d"row mood-list-row"\x3e\x3cdiv class\x3d"col-lg-1 col-md-1 col-sm-2 col-xs-2" style\x3d"text-align: center;margin-top: 10px;"\x3e',c=isNotEmpty(a.user_pic_path)?c+('\x3cimg width\x3d"40" height\x3d"40" class\x3d"img-circle hand" alt\x3d"" src\x3d"'+a.user_pic_path+'"  onclick\x3d"showSingleImg(this);"/\x3e'):c+'\x3cimg width\x3d"40" height\x3d"40" class\x3d"img-circle hand" alt\x3d"" src\x3d""/\x3e',c=c+('\x3c/div\x3e\x3cdiv class\x3d"col-lg-11 col-md-11 col-sm-10 col-xs-10"\x3e\x3cdiv class\x3d"row" style\x3d"font-family: \'\u5fae\u8f6f\u96c5\u9ed1\'; font-size: 15px; margin-top: 10px;"\x3e\x3cdiv class\x3d"col-lg-12"\x3e\x3cspan class\x3d"mood-user-name"\x3e\x3ca href\x3d"JavaScript:void(0);" onclick\x3d"linkToMy('+a.createUserId+')"\x3e'+changeNotNullString(a.account)+'\x3c/a\x3e\x3c/span\x3e  \x3cspan class\x3d"mood-create-time"\x3e\x26nbsp;\x26nbsp;'+changeNotNullString(a.createTime)+'\x3c/span\x3e\x3cspan class\x3d"mood-froms"\x3e\x26nbsp;\x26nbsp;'+changeNotNullString(a.froms)+'\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"row" style\x3d"font-family: \'\u5fae\u8f6f\u96c5\u9ed1\'; font-size: 17px;margin-top: 5px;"\x3e\x3cdiv class\x3d"col-lg-12"\x3e'+changeNotNullString(a.content)+"\x3c/div\x3e\x3c/div\x3e");isNotEmpty(a.location)&&(c+='\x3cdiv class\x3d"row" style\x3d"font-family: \'\u5b8b\u4f53\'; font-size: 12px;margin-top: 5px; color: gray; margin-bottom: 10px;"\x3e\x3cdiv class\x3d"col-lg-12"\x3e'+a.location+"\x3c/div\x3e\x3c/div\x3e");if(a.hasImg&&isNotEmpty(a.imgs)){for(var c=c+'\x3cdiv class\x3d"row"\x3e',d=a.imgs.split(";"),e=0;e<d.length;e++)c+='\x3cdiv class\x3d"col-lg-4 col-sm-4" style\x3d"margin-top: 5px;"\x3e\x3cimg width\x3d"100%" height\x3d"180" class\x3d"img-rounded hand" alt\x3d"" src\x3d"'+d[e]+'"  onclick\x3d"showImg('+b+", "+e+');"/\x3e\x3c/div\x3e';c+="\x3c/div\x3e"}return c+"\x3c/div\x3e\x3c/div\x3e"};