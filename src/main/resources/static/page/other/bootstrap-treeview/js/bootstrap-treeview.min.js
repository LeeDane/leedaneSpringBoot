/* =========================================================
 * bootstrap-treeview.js v1.2.0
 * =========================================================
 * Copyright 2013 Jonathan Miles
 * Project URL : http://www.jondmiles.com/bootstrap-treeview
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */
(function(c,l,n,g){var m,h,p;m={injectStyle:!0,levels:2,expandIcon:"glyphicon glyphicon-plus",collapseIcon:"glyphicon glyphicon-minus",emptyIcon:"glyphicon",nodeIcon:"",selectedIcon:"",checkedIcon:"glyphicon glyphicon-check",uncheckedIcon:"glyphicon glyphicon-unchecked",color:g,backColor:g,borderColor:g,onhoverColor:"#F5F5F5",selectedColor:"#FFFFFF",selectedBackColor:"#428bca",searchResultColor:"#D9534F",searchResultBackColor:g,enableLinks:!1,highlightSelected:!0,highlightSearchResults:!0,showBorder:!0,showIcon:!0,showCheckbox:!1,showTags:!1,multiSelect:!1,onNodeChecked:g,onNodeCollapsed:g,onNodeDisabled:g,onNodeEnabled:g,onNodeExpanded:g,onNodeSelected:g,onNodeUnchecked:g,onNodeUnselected:g,onSearchComplete:g,onSearchCleared:g};h={silent:!1,ignoreChildren:!1};p={ignoreCase:!0,exactMatch:!1,revealResults:!0};var d=function(a,b){this.$element=c(a);this.elementId=a.id;this.styleId=this.elementId+"-style";this.init(b);return{options:this.options,addNode:c.proxy(this.addNode,this),addNodes:c.proxy(this.addNodes,this),deleteNode:c.proxy(this.deleteNode,this),setDeleteNode:c.proxy(this.setDeleteNode,this),updateNode:c.proxy(this.updateNode,this),init:c.proxy(this.init,this),remove:c.proxy(this.remove,this),getNode:c.proxy(this.getNode,this),getParent:c.proxy(this.getParent,this),getSiblings:c.proxy(this.getSiblings,this),getSelected:c.proxy(this.getSelected,this),getUnselected:c.proxy(this.getUnselected,this),getExpanded:c.proxy(this.getExpanded,this),getCollapsed:c.proxy(this.getCollapsed,this),getChecked:c.proxy(this.getChecked,this),getUnchecked:c.proxy(this.getUnchecked,this),getDisabled:c.proxy(this.getDisabled,this),getEnabled:c.proxy(this.getEnabled,this),selectNode:c.proxy(this.selectNode,this),unselectNode:c.proxy(this.unselectNode,this),toggleNodeSelected:c.proxy(this.toggleNodeSelected,this),collapseAll:c.proxy(this.collapseAll,this),collapseNode:c.proxy(this.collapseNode,this),expandAll:c.proxy(this.expandAll,this),expandNode:c.proxy(this.expandNode,this),toggleNodeExpanded:c.proxy(this.toggleNodeExpanded,this),revealNode:c.proxy(this.revealNode,this),checkAll:c.proxy(this.checkAll,this),checkNode:c.proxy(this.checkNode,this),uncheckAll:c.proxy(this.uncheckAll,this),uncheckNode:c.proxy(this.uncheckNode,this),toggleNodeChecked:c.proxy(this.toggleNodeChecked,this),disableAll:c.proxy(this.disableAll,this),disableNode:c.proxy(this.disableNode,this),enableAll:c.proxy(this.enableAll,this),enableNode:c.proxy(this.enableNode,this),toggleNodeDisabled:c.proxy(this.toggleNodeDisabled,this),search:c.proxy(this.search,this),clearSearch:c.proxy(this.clearSearch,this)}};d.prototype.init=function(a){this.tree=[];this.nodes=[];a.data&&("string"===typeof a.data&&(a.data=c.parseJSON(a.data)),this.tree=c.extend(!0,[],a.data),delete a.data);this.options=c.extend({},m,a);this.destroy();this.subscribeEvents();this.setInitialStates({nodes:this.tree},0);this.render()};d.prototype.remove=function(){this.destroy();c.removeData(this,"treeview");c("#"+this.styleId).remove()};d.prototype.destroy=function(){this.initialized&&(this.$wrapper.remove(),this.$wrapper=null,this.unsubscribeEvents(),this.initialized=!1)};d.prototype.unsubscribeEvents=function(){this.$element.off("click");this.$element.off("nodeChecked");this.$element.off("nodeCollapsed");this.$element.off("nodeDisabled");this.$element.off("nodeEnabled");this.$element.off("nodeExpanded");this.$element.off("nodeSelected");this.$element.off("nodeUnchecked");this.$element.off("nodeUnselected");this.$element.off("searchComplete");this.$element.off("searchCleared")};d.prototype.subscribeEvents=function(){this.unsubscribeEvents();this.$element.on("click",c.proxy(this.clickHandler,this));if("function"===typeof this.options.onNodeChecked)this.$element.on("nodeChecked",this.options.onNodeChecked);if("function"===typeof this.options.onNodeCollapsed)this.$element.on("nodeCollapsed",this.options.onNodeCollapsed);if("function"===typeof this.options.onNodeDisabled)this.$element.on("nodeDisabled",this.options.onNodeDisabled);if("function"===typeof this.options.onNodeEnabled)this.$element.on("nodeEnabled",this.options.onNodeEnabled);if("function"===typeof this.options.onNodeExpanded)this.$element.on("nodeExpanded",this.options.onNodeExpanded);if("function"===typeof this.options.onNodeSelected)this.$element.on("nodeSelected",this.options.onNodeSelected);if("function"===typeof this.options.onNodeUnchecked)this.$element.on("nodeUnchecked",this.options.onNodeUnchecked);if("function"===typeof this.options.onNodeUnselected)this.$element.on("nodeUnselected",this.options.onNodeUnselected);if("function"===typeof this.options.onSearchComplete)this.$element.on("searchComplete",this.options.onSearchComplete);if("function"===typeof this.options.onSearchCleared)this.$element.on("searchCleared",this.options.onSearchCleared)};d.prototype.setInitialStates=function(a,b){if(a.nodes){b+=1;var e=this;c.each(a.nodes,function(c,f){f.nodeId=e.nodes.length;f.parentId=a.nodeId;f.hasOwnProperty("selectable")||(f.selectable=!0);f.state=f.state||{};f.state.hasOwnProperty("checked")||(f.state.checked=!1);f.state.hasOwnProperty("disabled")||(f.state.disabled=!1);f.state.hasOwnProperty("expanded")||(f.state.expanded=!f.state.disabled&&b<e.options.levels&&f.nodes&&0<f.nodes.length?!0:!1);f.state.hasOwnProperty("selected")||(f.state.selected=!1);e.nodes.push(f);f.nodes&&e.setInitialStates(f,b)})}};d.prototype.clickHandler=function(a){this.options.enableLinks||a.preventDefault();var b=c(a.target);(a=this.findNode(b))&&!a.state.disabled&&(b=b.attr("class")?b.attr("class").split(" "):[],-1!==b.indexOf("expand-icon")?this.toggleExpandedState(a,h):-1!==b.indexOf("check-icon")?this.toggleCheckedState(a,h):a.selectable?this.toggleSelectedState(a,h):this.toggleExpandedState(a,h),this.render())};d.prototype.findNode=function(a){a=a.closest("li.list-group-item").attr("data-nodeid");(a=this.nodes[a])||console.log("Error: node does not exist");return a};d.prototype.toggleExpandedState=function(a,b){a&&this.setExpandedState(a,!a.state.expanded,b)};d.prototype.setExpandedState=function(a,b,e){b!==a.state.expanded&&(b&&a.nodes?(a.state.expanded=!0,e.silent||this.$element.trigger("nodeExpanded",c.extend(!0,{},a))):b||(a.state.expanded=!1,e.silent||this.$element.trigger("nodeCollapsed",c.extend(!0,{},a)),a.nodes&&!e.ignoreChildren&&c.each(a.nodes,c.proxy(function(a,b){this.setExpandedState(b,!1,e)},this))))};d.prototype.toggleSelectedState=function(a,b){a&&this.setSelectedState(a,!a.state.selected,b)};d.prototype.setSelectedState=function(a,b,e){b!==a.state.selected&&(b?(this.options.multiSelect||c.each(this.findNodes("true","g","state.selected"),c.proxy(function(a,b){this.setSelectedState(b,!1,e)},this)),a.state.selected=!0,e.silent||this.$element.trigger("nodeSelected",c.extend(!0,{},a))):(a.state.selected=!1,e.silent||this.$element.trigger("nodeUnselected",c.extend(!0,{},a))))};d.prototype.toggleCheckedState=function(a,b){a&&this.setCheckedState(a,!a.state.checked,b)};d.prototype.setCheckedState=function(a,b,e){b!==a.state.checked&&(b?(a.state.checked=!0,e.silent||this.$element.trigger("nodeChecked",c.extend(!0,{},a))):(a.state.checked=!1,e.silent||this.$element.trigger("nodeUnchecked",c.extend(!0,{},a))))};d.prototype.setDisabledState=function(a,b,e){b!==a.state.disabled&&(b?(a.state.disabled=!0,this.setExpandedState(a,!1,e),this.setSelectedState(a,!1,e),this.setCheckedState(a,!1,e),e.silent||this.$element.trigger("nodeDisabled",c.extend(!0,{},a))):(a.state.disabled=!1,e.silent||this.$element.trigger("nodeEnabled",c.extend(!0,{},a))))};d.prototype.render=function(){this.initialized||(this.$element.addClass("treeview"),this.$wrapper=c(this.template.list),this.injectStyle(),this.initialized=!0);this.$element.empty().append(this.$wrapper.empty());this.buildTree(this.tree,0)};d.prototype.buildTree=function(a,b){if(a){b+=1;var e=this;c.each(a,function(a,f){for(var k=c(e.template.item).addClass("node-"+e.elementId).addClass(f.state.checked?"node-checked":"").addClass(f.state.disabled?"node-disabled":"").addClass(f.state.selected?"node-selected":"").addClass(f.searchResult?"search-result":"").attr("data-nodeid",f.nodeId).attr("style",e.buildStyleOverride(f)),d=0;d<b-1;d++)k.append(e.template.indent);d=[];f.nodes?(d.push("expand-icon"),f.state.expanded?d.push(e.options.collapseIcon):d.push(e.options.expandIcon)):d.push(e.options.emptyIcon);k.append(c(e.template.icon).addClass(d.join(" ")));e.options.showIcon&&(d=["node-icon"],d.push(f.icon||e.options.nodeIcon),f.state.selected&&(d.pop(),d.push(f.selectedIcon||e.options.selectedIcon||f.icon||e.options.nodeIcon)),k.append(c(e.template.icon).addClass(d.join(" "))));e.options.showCheckbox&&(d=["check-icon"],f.state.checked?d.push(e.options.checkedIcon):d.push(e.options.uncheckedIcon),k.append(c(e.template.icon).addClass(d.join(" "))));e.options.enableLinks?k.append(c(e.template.link).attr("href",f.href).append(f.text)):k.append(f.text);e.options.showTags&&f.tags&&c.each(f.tags,function(a,b){k.append(c(e.template.badge).append(b))});e.$wrapper.append(k);if(f.nodes&&f.state.expanded&&!f.state.disabled)return e.buildTree(f.nodes,b)})}};d.prototype.buildStyleOverride=function(a){if(a.state.disabled)return"";var b=a.color,e=a.backColor;this.options.highlightSelected&&a.state.selected&&(this.options.selectedColor&&(b=this.options.selectedColor),this.options.selectedBackColor&&(e=this.options.selectedBackColor));this.options.highlightSearchResults&&a.searchResult&&!a.state.disabled&&(this.options.searchResultColor&&(b=this.options.searchResultColor),this.options.searchResultBackColor&&(e=this.options.searchResultBackColor));return"color:"+b+";background-color:"+e+";"};d.prototype.injectStyle=function(){this.options.injectStyle&&!n.getElementById(this.styleId)&&c('\x3cstyle type\x3d"text/css" id\x3d"'+this.styleId+'"\x3e '+this.buildStyle()+" \x3c/style\x3e").appendTo("head")};d.prototype.buildStyle=function(){var a=".node-"+this.elementId+"{";this.options.color&&(a+="color:"+this.options.color+";");this.options.backColor&&(a+="background-color:"+this.options.backColor+";");this.options.showBorder?this.options.borderColor&&(a+="border:1px solid "+this.options.borderColor+";"):a+="border:none;";a+="}";this.options.onhoverColor&&(a+=".node-"+this.elementId+":not(.node-disabled):hover{background-color:"+this.options.onhoverColor+";}");return this.css+a};d.prototype.template={list:'\x3cul class\x3d"list-group"\x3e\x3c/ul\x3e',item:'\x3cli class\x3d"list-group-item" onclick\x3d"itemClick(this, \'customItemClick\');"\x3e\x3c/li\x3e',indent:'\x3cspan class\x3d"indent"\x3e\x3c/span\x3e',icon:'\x3cspan class\x3d"icon"\x3e\x3c/span\x3e',link:'\x3ca href\x3d"#" style\x3d"color:inherit;"\x3e\x3c/a\x3e',badge:'\x3cspan class\x3d"badge"\x3e\x3c/span\x3e'};d.prototype.css=".treeview .list-group-item{cursor:pointer}.treeview span.indent{margin-left:10px;margin-right:10px}.treeview span.icon{width:12px;margin-right:5px}.treeview .node-disabled{color:silver;cursor:not-allowed}";d.prototype.getNode=function(a){return this.nodes[a]};d.prototype.getParent=function(a){a=this.identifyNode(a);return this.nodes[a.parentId]};d.prototype.getSiblings=function(a){var b=this.identifyNode(a);a=this.getParent(b);return(a?a.nodes:this.tree).filter(function(a){return a.nodeId!==b.nodeId})};d.prototype.getSelected=function(){return this.findNodes("true","g","state.selected")};d.prototype.getUnselected=function(){return this.findNodes("false","g","state.selected")};d.prototype.getExpanded=function(){return this.findNodes("true","g","state.expanded")};d.prototype.getCollapsed=function(){return this.findNodes("false","g","state.expanded")};d.prototype.getChecked=function(){return this.findNodes("true","g","state.checked")};d.prototype.getUnchecked=function(){return this.findNodes("false","g","state.checked")};d.prototype.getDisabled=function(){return this.findNodes("true","g","state.disabled")};d.prototype.getEnabled=function(){return this.findNodes("false","g","state.disabled")};d.prototype.selectNode=function(a,b){this.forEachIdentifier(a,b,c.proxy(function(a,b){this.setSelectedState(a,!0,b)},this));this.render()};d.prototype.unselectNode=function(a,b){this.forEachIdentifier(a,b,c.proxy(function(a,b){this.setSelectedState(a,!1,b)},this));this.render()};d.prototype.toggleNodeSelected=function(a,b){this.forEachIdentifier(a,b,c.proxy(function(a,b){this.toggleSelectedState(a,b)},this));this.render()};d.prototype.collapseAll=function(a){var b=this.findNodes("true","g","state.expanded");this.forEachIdentifier(b,a,c.proxy(function(a,b){this.setExpandedState(a,!1,b)},this));this.render()};d.prototype.collapseNode=function(a,b){this.forEachIdentifier(a,b,c.proxy(function(a,b){this.setExpandedState(a,!1,b)},this));this.render()};d.prototype.expandAll=function(a){if((a=c.extend({},h,a))&&a.levels)this.expandLevels(this.tree,a.levels,a);else{var b=this.findNodes("false","g","state.expanded");this.forEachIdentifier(b,a,c.proxy(function(a,b){this.setExpandedState(a,!0,b)},this))}this.render()};d.prototype.expandNode=function(a,b){this.forEachIdentifier(a,b,c.proxy(function(a,b){this.setExpandedState(a,!0,b);a.nodes&&b&&b.levels&&this.expandLevels(a.nodes,b.levels-1,b)},this));this.render()};d.prototype.expandLevels=function(a,b,e){e=c.extend({},h,e);c.each(a,c.proxy(function(a,c){this.setExpandedState(c,0<b?!0:!1,e);c.nodes&&this.expandLevels(c.nodes,b-1,e)},this))};d.prototype.revealNode=function(a,b){this.forEachIdentifier(a,b,c.proxy(function(a,b){for(var e=this.getParent(a);e;)this.setExpandedState(e,!0,b),e=this.getParent(e)},this));this.render()};d.prototype.toggleNodeExpanded=function(a,b){this.forEachIdentifier(a,b,c.proxy(function(a,b){this.toggleExpandedState(a,b)},this));this.render()};d.prototype.checkAll=function(a){var b=this.findNodes("false","g","state.checked");this.forEachIdentifier(b,a,c.proxy(function(a,b){this.setCheckedState(a,!0,b)},this));this.render()};d.prototype.checkNode=function(a,b){this.forEachIdentifier(a,b,c.proxy(function(a,b){this.setCheckedState(a,!0,b)},this));this.render()};d.prototype.uncheckAll=function(a){var b=this.findNodes("true","g","state.checked");this.forEachIdentifier(b,a,c.proxy(function(a,b){this.setCheckedState(a,!1,b)},this));this.render()};d.prototype.uncheckNode=function(a,b){this.forEachIdentifier(a,b,c.proxy(function(a,b){this.setCheckedState(a,!1,b)},this));this.render()};d.prototype.toggleNodeChecked=function(a,b){this.forEachIdentifier(a,b,c.proxy(function(a,b){this.toggleCheckedState(a,b)},this));this.render()};d.prototype.disableAll=function(a){var b=this.findNodes("false","g","state.disabled");this.forEachIdentifier(b,a,c.proxy(function(a,b){this.setDisabledState(a,!0,b)},this));this.render()};d.prototype.disableNode=function(a,b){this.forEachIdentifier(a,b,c.proxy(function(a,b){this.setDisabledState(a,!0,b)},this));this.render()};d.prototype.enableAll=function(a){var b=this.findNodes("true","g","state.disabled");this.forEachIdentifier(b,a,c.proxy(function(a,b){this.setDisabledState(a,!1,b)},this));this.render()};d.prototype.enableNode=function(a,b){this.forEachIdentifier(a,b,c.proxy(function(a,b){this.setDisabledState(a,!1,b)},this));this.render()};d.prototype.toggleNodeDisabled=function(a,b){this.forEachIdentifier(a,b,c.proxy(function(a,b){this.setDisabledState(a,!a.state.disabled,b)},this));this.render()};d.prototype.forEachIdentifier=function(a,b,e){b=c.extend({},h,b);a instanceof Array||(a=[a]);c.each(a,c.proxy(function(a,c){e(this.identifyNode(c),b)},this))};d.prototype.identifyNode=function(a){return"number"===typeof a?this.nodes[a]:a};d.prototype.search=function(a,b){b=c.extend({},p,b);this.clearSearch({render:!1});var e=[];a&&0<a.length&&(b.exactMatch&&(a="^"+a+"$"),e="g",b.ignoreCase&&(e+="i"),e=this.findNodes(a,e),c.each(e,function(a,b){b.searchResult=!0}));b.revealResults?this.revealNode(e):this.render();this.$element.trigger("searchComplete",c.extend(!0,{},e));return e};d.prototype.clearSearch=function(a){a=c.extend({},{render:!0},a);var b=c.each(this.findNodes("true","g","searchResult"),function(a,b){b.searchResult=!1});a.render&&this.render();this.$element.trigger("searchCleared",c.extend(!0,{},b))};d.prototype.findNodes=function(a,b,e){b=b||"g";e=e||"text";var d=this;return c.grep(this.nodes,function(c){c=d.getNodeValue(c,e);if("string"===typeof c)return c.match(new RegExp(a,b))})};d.prototype.addNode=function(a,b){this.forEachIdentifier(a,b,c.proxy(function(a,b){this.setAddNode(a,b)},this));this.setInitialStates({nodes:this.tree},0);this.render()};d.prototype.setAddNode=function(a,b){null==a.nodes&&(a.nodes=[]);if(b.node){var c=a.nodes,d=!1;if(c&&0<c.length)for(var f=0;f<c.length&&!(d=c[f].text==b.node.text);f++);d?layer.msg("\u5e73\u7ea7\u7684\u8282\u70b9\u540d\u79f0\u5fc5\u987b\u662f\u552f\u4e00\u7684"):(a.state.expanded=!0,a.nodes.push(b.node))}};d.prototype.addNodes=function(a,b){this.forEachIdentifier(a,b,c.proxy(function(a,b){this.setAddNodes(a,b)},this));this.setInitialStates({nodes:this.tree},0);this.render()};d.prototype.setAddNodes=function(a,b){a.nodes=[];if(b.node){var c=a.nodes,d=!1;if(c&&0<c.length)for(var f=0;f<c.length&&(b.node&&0<b.node.length&&(d=c[f].text==b.node[f].text),!d);f++);if(d)layer.msg("\u5e73\u7ea7\u7684\u8282\u70b9\u540d\u79f0\u5fc5\u987b\u662f\u552f\u4e00\u7684");else if(b.node&&0<b.node.length)for(f=0;f<b.node.length;f++)a.nodes.push(b.node[f])}};d.prototype.updateNode=function(a,b){this.forEachIdentifier(a,b,c.proxy(function(a,b){this.setUpdateNode(a,b)},this));this.setInitialStates({nodes:this.tree},0);this.render()};d.prototype.setUpdateNode=function(a,b){if(b.node){var c=!1,d=a.nodes;if(d&&0<d.length)for(var f=0;f<d.length&&!(c=d[f].text==b.node.text);f++);c?layer.msg("\u5e73\u7ea7\u7684\u8282\u70b9\u540d\u79f0\u5fc5\u987b\u662f\u552f\u4e00\u7684"):a.text=b.node.text}};d.prototype.deleteNode=function(a,b){this.forEachIdentifier(a,b,c.proxy(function(a,b){var c=this.getParent(a);this.setDeleteNode(c,a,b)},this))};d.prototype.setDeleteNode=function(a,b,c){if(a&&null!=a.nodes){for(c=a.nodes.length-1;0<=c;c--){var d=a.nodes[c];d.nodeId==b.nodeId&&a.nodes.splice(c,1)}a.nodes&&1>a.nodes.length&&delete a.nodes}else for(c=this.tree.length-1;0<=c;c--)d=this.tree[c],d.nodeId==b.nodeId&&this.tree.splice(c,1);this.setInitialStates({nodes:this.tree},0);this.render()};d.prototype.getNodeValue=function(a,b){var c=b.indexOf(".");if(0<c){var d=a[b.substring(0,c)],c=b.substring(c+1,b.length);return this.getNodeValue(d,c)}return a.hasOwnProperty(b)?a[b].toString():g};c.fn.treeview=function(a,b){var e;this.each(function(){var g=c.data(this,"treeview");"string"===typeof a?g?c.isFunction(g[a])&&"_"!==a.charAt(0)?(b instanceof Array||(b=[b]),e=g[a].apply(g,b)):l.console&&l.console.error("No such method : "+a):l.console&&l.console.error("Not initialized, can not call method : "+a):"boolean"===typeof a?e=g:c.data(this,"treeview",new d(this,c.extend(!0,{},a)))});return e||this}})(jQuery,window,document);function itemClick(c,l){try{if("function"==typeof eval(l)){try{eval("getTreeRootId")}catch(m){console.log("\u65e0\u6cd5\u6267\u884c\u51fd\u6570getTreeRootId();\u8fd4\u56de\u6839tree\u7684id\u9009\u62e9\u5668\u540d\u79f0");return}var n=$(c).attr("data-nodeid"),g=$("#tree").treeview("getNode",n);new (eval(l))(g)}}catch(m){console.log("\u65e0\u6cd5\u6267\u884c\u51fd\u6570customItemClick();\u8fd9\u662f\u5bf9\u9879\u7684\u70b9\u51fb\u89e6\u53d1\u7684\u51fd\u6570")}};